\documentclass[,%fontsize=10pt,%
	paper=25cm:25cm,% 
	%landscape,
	%DIV12, % mehr text pro seite als defaultyyp
	DIV22,
	%DIV=calc,%
	%twoside=false,%
	liststotoc,
	bibtotoc,
	draft=false,% final|draft % draft ist platzsparender (kein code, bilder..)
	%titlepage,
	numbers=noendperiod
]{scrartcl}


\usepackage{lscape}
\usepackage{stackengine}


\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}

\usepackage{enumerate}
\usepackage{paralist}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,backgrounds,graphs,%
	matrix,patterns,arrows,decorations.pathmorphing,decorations.pathreplacing,%
	positioning,fit,calc,decorations.text,shadows%
}


\input{../latex_header.tex}

%\usepackage{bussproof}

%\usepackage{vaucanson-g}
\usepackage{amssymb}
\usepackage{latexsym}

% for color-highlighted code
%\usepackage{color} % for grey comments
%\usepackage{alltt}

%\usepackage[doublespacing]{setspace}
\usepackage[onehalfspacing]{setspace}
%\usepackage[singlespacing]{setspace}
\usepackage{tabularx}
\usepackage{hyperref}
\usepackage{comment}
\usepackage{color}
\usepackage[final]{listings} % sourcecode in document
\usepackage{url}      % for urls
\usepackage{multicol}
\usepackage{float}
\usepackage{caption}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{graphicx}

\usepackage[authoryear]{natbib} % \cite ; square|round etc.
%\usepackage[numbers,square]{natbib}
%\usepackage[square, authoryear]{natbib}
%\usepackage[language=english]{biblatex}

%\bibliographystyle{plain}
\bibliographystyle{alpha}
%\bibliographystyle{alphadin}
%\bibliographystyle{dinat}
%\bibliographystyle{chicago}
%\bibliographystyle{plainnat}

\bibdata{bib.bib}

\renewcommand*{\partformat}{\partname\ \thepart\ -}
\let\partheadmidvskip\

\newcommand{\comp}{\ensuremath{\text{comp}}}
% smaller url style
\makeatletter
\def\url@leostyle{%
\@ifundefined{selectfont}{\def\UrlFont{\sf}}{\def\UrlFont{\small\ttfamily}}}
\makeatother
\urlstyle{leo}

\newcommand{\myfig}[5] {
	\begin{figure}[tbph]
		\centering
		\includegraphics[#3]{#1}
		\caption[#4]{#5}
		\label{fig:#2}
	\end{figure}
}

\setlength{\parindent}{0em}
%\usepackage{thmtools} % actually already in latex_header.tex ...

\usepackage{amsthm}

\theoremstyle{definition}
\newtheorem{thm}{Theorem}

\usepackage{tikz-qtree}

%\newcommand{\sig}[1]{{#1}_\Sigma}
%\newcommand{\p}[1]{{#1}_\Pi}
\newcommand{\sig}[1]{\stackrel{\Sigma}{#1}}
\newcommand{\p}[1]{\stackrel{\Pi}{#1}}

\newcommand{\e}[1]{\vskip .7em   \subsection*{#1}}

\def\proofSkipAmount{ \vskip -2em}

\begin{document}

\newcommand{\ha}[1]{ {\color{red} #1} }
\newcommand{\hb}[1]{ {\color{blue} #1} }
\newcommand{\hc}[1]{ {\color{violet} #1} }
\section*{Example 101: canonical examples for overbinding w.r.t. order }
Here, the second lower prooftree shows what huang would produce.

\e{Ex 101a}

\begin{prooftree}
	\AxiomCm{\sig{P(\ha u, f(\ha u)) \lor Q(\ha u)}  }
	\AxiomCm{\p{\lnot Q(a)} }
	\RightLabelm{u\mapsto a}
	\BinaryInfCm{P(a, f(a))}

	\AxiomCm{\p{\lnot P(x, y)} }
	\RightLabelm{x\mapsto a, y\mapsto f(a) }
	\BinaryInfCm{\square}
\end{prooftree}

\begin{multicols}{2}
	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{u\mapsto a}
		\BinaryInfCm{Q(a)}

		\AxiomCm{\top}
		\RightLabelm{x\mapsto a, y\mapsto f(a) }
		\BinaryInfCm{ P(a, f(a)) \lor Q(a)}
	\end{prooftree}
	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\BinaryInfCm{\forall x_1 Q(x_1)}

		\AxiomCm{\top}
		\BinaryInfCm{  \forall x_1 \exists x_2 (P(x_1, x_2) \lor Q(x_1)) }
	\end{prooftree}

\end{multicols}

Direct overbinding would not work without merging same variables!: $\forall x_1 \forall x_2 \exists x_3 ( P(x_2, x_3) \lor Q(x_1) )$

counterexample: $Q \sim \{0\}, P\sim \{(1,0)\} $

Direct overbinding would work when considering original dependencies as highlighted above

arrow lemma:
\begin{prooftree}
	\AxiomCm{\Gamma \entails \sig{\exists y_1 (P(\ha u, y_1) \lor Q(\ha u) \lor \bot)}  }
	\AxiomCm{\Gamma \entails \p{\lnot Q(x_1) \lor \top} }
	\RightLabelm{u\mapsto a}
	\BinaryInfCm{\Gamma \entails \exists y_1 ( P(\ha{x_1}, y_1) \lor Q(\ha{x_1}))}

	\AxiomCm{\Gamma \entails \p{\lnot P(x, y) \lor \top} }
	\RightLabelm{x\mapsto a, y\mapsto f(a) }
	\BinaryInfCm{\Gamma \entails (\forall x_1) \exists y_1 ( Q(\ha{x_1}) \lor P(\ha{x_1}, y_1))}
\end{prooftree}

\bigskip

\e{Ex 101b -- other resolution order}
\begin{prooftree}
	\AxiomCm{\sig{P(u, f(u)) \lor Q(u)}  }
	\AxiomCm{\p{\lnot P(x, y)} }
	\RightLabelm{y\mapsto f(u), x\mapsto u}
	\BinaryInfCm{Q(u))}

	\AxiomCm{\p{\lnot Q(a)} }
	\RightLabelm{u\mapsto a}
	\BinaryInfCm{\square}
\end{prooftree}

\begin{multicols}{2}
	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{x\mapsto f(u), x\mapsto u}
		\BinaryInfCm{P(u, f(u))}

		\AxiomCm{\top}
		\RightLabelm{u\mapsto a}
		\BinaryInfCm{ P(a, f(a)) \lor Q(a)  }
	\end{prooftree}
	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\BinaryInfCm{\exists x_1 P(u, x_1)}

		\AxiomCm{\top}
		\RightLabelm{u\mapsto a}
		\BinaryInfCm{ \forall x_1 \exists x_2 ( P(x_1, x_2) \lor Q(x_1) ) }
	\end{prooftree}
\end{multicols}



\e{Ex 101c --  $\Pi$ and $\Sigma$ swapped}
\begin{prooftree}
	\AxiomCm{\p{P(u, f(u)) \lor Q(u)}  }
	\AxiomCm{\sig{\lnot P(x, y)} }
	\RightLabelm{y\mapsto f(u), x\mapsto u}
	\BinaryInfCm{Q(u))}

	\AxiomCm{\sig{\lnot Q(a)} }
	\RightLabelm{u\mapsto a}
	\BinaryInfCm{\square}
\end{prooftree}

\begin{multicols}{2}
	\begin{prooftree}
		\AxiomCm{\top}
		\AxiomCm{\bot}
		\RightLabelm{x\mapsto f(u), x\mapsto u}
		\BinaryInfCm{\lnot P(u, f(u))}

		\AxiomCm{\bot}
		\RightLabelm{u\mapsto a}
		\BinaryInfCm{ \lnot P(a, f(a)) \land \lnot Q(a)  }
	\end{prooftree}
	\begin{prooftree}
		\AxiomCm{\top}
		\AxiomCm{\bot}
		\BinaryInfCm{\forall x_2 \lnot P(u, x_2)}

		\AxiomCm{\bot}
		\BinaryInfCm{ \exists x_1 \forall x_2 ( \lnot P(x_1, x_2) \land \lnot Q(x_1)  )}
	\end{prooftree}
\end{multicols}

arrow lemma:
\begin{prooftree}
	\AxiomCm{\Gamma \entails \p{P(u, x_1) \lor Q(u)} \lor \top  }
	\AxiomCm{\Gamma \entails \sig{\lnot P(x, y)} \lor \bot }
	\RightLabelm{y\mapsto f(u), x\mapsto u}
	\BinaryInfCm{\Big( Q(u) \mid  (\lnot P(x, x_1) \land \top) \lor (P(u, /f(u)) \land \bot)\Big)\sigma}
	\noLine
	\UnaryInfCm{Q(u) \mid  (\lnot P(u, x_1) \land \top) \lor (P(u, f(u)) \land \bot)}
	\noLine
	\UnaryInfCm{\text{ employ $\sigma'$ !?!!?!?!?!??!?????!!!}}
	\noLine
	\UnaryInfCm{\Gamma \entails Q(u) \mid \lnot P(u, x_1)}
	\noLine
	\UnaryInfCm{\Delta \entails Q(u) \mid \exists x_1 P(u, x_1)}

	\AxiomCm{\Gamma \entails \exists y_1 \sig{\lnot Q(y_1)} }
	\RightLabelm{u\mapsto a}
	\BinaryInfCm{\text{ both $u$'s on LHS need to become $a$ and then $y_1$ }}
	\noLine
	\UnaryInfCm{\Gamma \entails (\forall x_1) \exists y_1 (\lnot P(y_1, x_1) \lor \lnot Q(y_1))}
	\noLine
	\UnaryInfCm{\Delta \entails (\exists x_1) \forall y_1 (P(y_1, x_1) \land Q(y_1))}
\end{prooftree}



\e{Ex 101d --  $\Pi$ and $\Sigma$ swapped, other resolution order}
\begin{prooftree}
	\AxiomCm{\p{P(u, f(u)) \lor Q(u)}  }
	\AxiomCm{\sig{\lnot Q(a)} }
	\RightLabelm{u\mapsto a}
	\BinaryInfCm{P(a, f(a))}

	\AxiomCm{\sig{\lnot P(x, y)} }
	\RightLabelm{x\mapsto a, y\mapsto f(a)}
	\BinaryInfCm{\square}
\end{prooftree}
~ % latex makes pagebreak without this, bug?
\begin{multicols}{2}
	\begin{prooftree}
		\AxiomCm{\top}
		\AxiomCm{\bot}
		\RightLabelm{y\mapsto a}
		\BinaryInfCm{\lnot Q(a)}

		\AxiomCm{\bot}
		\RightLabelm{x\mapsto a, y\mapsto f(a)}
		\BinaryInfCm{ \lnot Q(a) \land \lnot P(a, f(a)) }
	\end{prooftree}
	\begin{prooftree}
		\AxiomCm{\top}
		\AxiomCm{\bot}
		\BinaryInfCm{\exists x_1 \lnot Q(x_1)}

		\AxiomCm{\bot}
		\BinaryInfCm{ \exists x_1 \forall x_2 ( \lnot P(x_1, x_2) \land \lnot Q(x_1)  )}
	\end{prooftree}
\end{multicols}


\section*{102 -- similar to 101 but with intra-clause-set inferences}


\e{Ex 102a}

\begin{prooftree}
	\AxiomCm{ \sig{P(f(\ha x)) \lor Q(f(\ha x), z)} }
	\AxiomCm{ \p{\lnot P(y) } }
	\BinaryInfCm{ Q(f(x), z) }

	\AxiomCm{ \sig{\lnot Q(x_1, \hb y) \lor R(\hb y) } }
	\AxiomCm{ \p{\lnot R(g(z_1)) } }
	\RightLabelm{y \mapsto g(z_1), x_1 \mapsto f(x)}
	\BinaryInfCm{ \lnot Q(x_1, g(z_1)) }

	\RightLabelm{x_1 \mapsto f(x), z \mapsto g(z_1)}
	\BinaryInfCm{ \square }
\end{prooftree}

\begin{multicols}{2}

	\begin{prooftree}
		\AxiomCm{ \bot }
		\AxiomCm{ \top}
		\BinaryInfCm{ P(f(x))}

		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\RightLabelm{y \mapsto g(z_1), x_1 \mapsto f(x)}
		\BinaryInfCm{ R(g(z_1)) }

		\RightLabelm{x_1 \mapsto f(x), z \mapsto g(z_1)}
		\BinaryInfCm{ P(f(x)) \lor R(g(z_1)) }

	\end{prooftree}

	\begin{prooftree}
		\AxiomCm{ \bot }
		\AxiomCm{ \top}
		\BinaryInfCm{ \exists x_1 P(x_1)}

		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\BinaryInfCm{ \forall x_2 R(x_2) }

		\BinaryInfCm{ \exists x_1 \forall x_2 ( P(x_1) \lor R(x_2) ) \quad\text{(order irrelevant!)} } 


	\end{prooftree}

\end{multicols}

combined:
	\begin{prooftree}
		\AxiomCm{ \bot \mid {P(x_1) \lor Q(x_1, z)}}
		\AxiomCm{ \top}
		\BinaryInfCm{ \exists x_1 P(x_1)}

		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\BinaryInfCm{ \forall x_2 R(x_2) }

		\BinaryInfCm{ \exists x_1 \forall x_2 ( P(x_1) \lor R(x_2) ) }


	\end{prooftree}


\bigskip

\e{Ex 102b}

\begin{prooftree}
	\AxiomCm{ \sig{P(f(\ha x)) \lor Q(f(\ha x), z)} }
	\AxiomCm{ \p{\lnot P(y) } }
	\BinaryInfCm{ Q(f(x), z) }

	\AxiomCm{ \sig{\lnot Q(f(\hb y), z_1) \lor R(\hb y)} }
	\AxiomCm{ \p{\lnot R(a) } }
	\RightLabelm{y \mapsto a}
	\BinaryInfCm{ \lnot Q(f(a), z_1) }

	\RightLabelm{x \mapsto a, z \mapsto z_1}
	\BinaryInfCm{ \square }
\end{prooftree}

\begin{multicols}{2}

	\begin{prooftree}
		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\BinaryInfCm{ P(f(x)) }

		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\RightLabelm{y \mapsto a}
		\BinaryInfCm{ R(a) }

		\RightLabelm{x \mapsto a, z \mapsto z_1}
		\BinaryInfCm{ P(f(a)) \lor R(a) }

	\end{prooftree}

	\begin{prooftree}
		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\BinaryInfCm{ \exists x_1 P(x_1) }

		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\RightLabelm{y \mapsto a}
		\BinaryInfCm{ \forall x_2 R(x_2) }

		\RightLabelm{x \mapsto a, z \mapsto z_1}
		\BinaryInfCm{ \forall x_2 \exists x_1 ( P(x_1) \lor R(x_2) ) }

	\end{prooftree}

\end{multicols}
	direct:
	\begin{prooftree}
		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\RightLabelm{x_1 \sim f(x)}
		\BinaryInfCm{ \exists x_1 P(x_1) }

		\AxiomCm{ \bot }
		\AxiomCm{ \top }
		\RightLabelm{x_2 \sim a}
		\BinaryInfCm{ \forall x_2 R(x_2) }

		\RightLabel{ order irrelevant!}
		\BinaryInfCm{ \exists x_1 \forall x_2 (P(x_1) \lor R(x_2)) }
	

	\end{prooftree}


	\clearpage

\e{Ex 102b' with $Q$ grey}

\begin{prooftree}
	\AxiomCm{ \sig{P(f(\ha x)) \lor Q(f(\ha x), z)} }
	\AxiomCm{ \p{\lnot P(y) } }
	\BinaryInfCm{ Q(f(x), z) }

	\AxiomCm{ \sig{\lnot Q(f(\hb y), z_1) \lor R(\hb y)} }
	\AxiomCm{ \p{\lnot R(a) } }
	\RightLabelm{y \mapsto a}
	\BinaryInfCm{ \lnot Q(f(a), z_1) }

	\RightLabelm{x \mapsto a, z_1 \mapsto z}
	\BinaryInfCm{ \square }
\end{prooftree}

~

\begin{prooftree}
	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\BinaryInfCm{ P(f(x)) }

	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\RightLabelm{y \mapsto a}
	\BinaryInfCm{ R(a) }

	\RightLabelm{x \mapsto a, z_1 \mapsto z}
	\BinaryInfCm{ (\lnot Q(f(a), z) \land P(f(a))) \lor (Q(f(a), z) \land R(a) )  }

\end{prooftree}


arrow lemma: (change of specification: $P(g(z_3))$ in clause in $\Sigma$ instead of $P(f(x))$
\begin{prooftree}
	\AxiomCm{ \exists x_1 (\sig{P(x_4) \lor Q(x_1, z)}) }
	\AxiomCm{ \p{\lnot P(y) } }
	\BinaryInfCm{\exists x_1 (P(g(z_3)) \land \bot) \lor (P(x_4) \land \top) \mid Q(x_1, z) }
	\noLine
	\UnaryInfCm{ \exists x_1 (P(x_4) \mid  Q(x_1, z) ) }

	\AxiomCm{\exists x_2( \sig{\lnot Q(x_2, z_1) \lor R(y)} )}
	\AxiomCm{ \forall x_3 \p{\lnot R(x_3) } }
	\RightLabelm{y \mapsto a}
	\BinaryInfCm{ \stackrel{\forall x_3}{\exists x_2} ( (\lnot R(x_3) \land \bot ) \lor ( R(a) \land \top ) \mid \lnot Q(x_2, z_1)) }
	\noLine
	\UnaryInfCm{ \stackrel{\forall x_3}{\exists x_2} ( (\lnot R(x_3) \land \bot ) \lor ( R(x_3) \land \top ) \mid \lnot Q(x_2, z_1)) }

	\RightLabelm{x \mapsto a, z_1 \mapsto z}
	\BinaryInfCm{ \stackrel{\forall x_1}{\stackrel{\forall x_3}{\exists x_2}} \Big( (\lnot Q(x_2, z_1) \land P(x_4)) \lor (Q(x_1, z) \land R(x_3))  \Big) }
\end{prooftree}

arrow order: $x_3 < x_2$, $x_2 \operatorname{same-block-as} x_4 $:
$ \forall x_3 \exists x_2 \exists x_4 \forall x_1 \Big( (\lnot Q(x_2, z_1) \land \lnot P(x_4)) \lor (Q(x_1, z) \land R(x_3))  \Big) $
\newline{
	\huge
	$\ra$ bad example, plus some errors still in there
	\medskip

}


Huang:
\begin{prooftree}
	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\BinaryInfCm{ \exists x_2 P(x_2) }

	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\RightLabelm{y \mapsto a}
	\BinaryInfCm{ \forall x_1 R(x_1) }

	\RightLabelm{x \mapsto a, z_1 \mapsto z}
	\BinaryInfCm{ \forall x_1 \exists x_2 (\lnot Q(x_2, z) \land P(x_2)) \lor (Q(x_2, z) \land R(x_1) )  }

\end{prooftree}

direct:
\begin{prooftree}
	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\RightLabelm{x_2 \sim f(x)}
	\BinaryInfCm{ \exists x_2 P(x_2) }

	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\RightLabelm{x_1 \sim a}
	\BinaryInfCm{ \forall x_1 R(x_1) }

	\RightLabelm{ x_3 \sim f(a); x_2 \parallel x_3, x_1 < x_3   }
	\BinaryInfCm{ \forall x_1 \exists x_2 \exists x_3 (\lnot Q(x_3, z) \land P(x_2)) \lor (Q(x_3, z) \land R(x_1) )  }

	\UnaryInfCm{ \text{OR: }~ \exists x_2 \forall x_1 \exists x_3  (\lnot Q(x_3, z) \land P(x_2)) \lor (Q(x_3, z) \land R(x_1) )  }
	\UnaryInfCm{ \text{OR: }~ \exists x_1 \exists x_3 \forall x_2  (\lnot Q(x_3, z) \land P(x_2)) \lor (Q(x_3, z) \land R(x_1) )  }


\end{prooftree}

Huang-Version passt weil man fÃ¼r existenzielle quantoren eh gleichen term einsetzt

direct w mixed, slightly different:
\begin{prooftree}
	\AxiomCm{ \bot \mid P(f(\arrowB x)) \lor Q(\arrowA x, z) \drawAB}
	\AxiomCm{ \top \mid \lnot P(y)}
	\RightLabelm{x_2 \sim f(x)}
	\BinaryInfCm{ \exists \arrowB x_2 P(x_2) \mid Q(\arrowA x, z) \drawAB }

	\AxiomCm{ \bot \mid  \sig{\lnot Q(f(\arrowB y), z_1) \lor R(\arrowA y)} } \drawAB
	\AxiomCm{ \top \mid \p{\lnot R(a) } }
	\RightLabelm{x_1 \sim a}
	\BinaryInfCm{ \forall \arrowA x_1 R(x_1) \mid \lnot Q(f(\arrowB a), z_1) } \drawAB

	\RightLabelm{ x_3 \sim f(a); x_2 \parallel x_3, x_1 < x_3   }
	\BinaryInfCm{ \forall \arrowA x_1 \exists \arrowB\,\arrowC x_3 \exists \arrowD\drawCD x_2 (\lnot Q(x_3, z) \land P(x_2)) \lor (Q(x_3, z) \land R(x_1) )  } \drawAB\drawCD
	\UnaryInfCm{ (\lnot Q(f(a), z) \land P(f(f(a)))) \lor (Q(f(a), z) \land R(a) )  } 
\end{prooftree}

last dependency not crucial because other arrow is a $\Sigma$-arrow as well, but just changing it to $\Pi$ (and changing $f$ for $g$ should produce a quantifier alternation)


\bigskip

\clearpage
\section*{Example 103: variables in interpolant get unified and order might have to be changed}

\e{103a: length changes but old version is still valid, despite huang's algorithm doing a sort}


\begin{prooftree}
	\AxiomCm{\sig{Q(f(\ha x))\lor P(y)\lor R(\ha x)}}
	\AxiomCm{\p{\lnot Q(y_1)}}

	\RightLabelm{y_1\mapsto f(x)}
	\BinaryInfCm{P(y)\lor R(x)}

	\AxiomCm{\p{\lnot P(h(g(a)))}}
	\RightLabelm{y\mapsto h(g(a))}
	\BinaryInfCm{ R(x)}

	\AxiomCm{\p{\lnot R(g(g(a)))}}
	\RightLabelm{x\mapsto g(g(a))}
	\BinaryInfCm{\square}
\end{prooftree}

\begin{multicols}{2}


	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}

		\RightLabelm{y_1\mapsto f(x)}
		\BinaryInfCm{Q(f(x))}

		\AxiomCm{\top}
		\RightLabelm{y\mapsto h(g(a))}
		\BinaryInfCm{ Q(f(x)) \lor P(h(g(a)))}

		\AxiomCm{\top}
		\RightLabelm{x\mapsto g(g(a))}
		\BinaryInfCm{ Q(f(g(g(a)))) \lor P(h(g(a))) \lor R(g(g(a)))}
	\end{prooftree}

	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}

		\BinaryInfCm{\exists x_1 Q(x_1)}

		\AxiomCm{\top}
		\BinaryInfCm{ \exists x_1 \forall x_2 (Q(x_1) \lor P(x_2))}

		\AxiomCm{\top}
		\BinaryInfCm{ X } 
	\end{prooftree}

\end{multicols}

$X$: 

Huang's algo gives:

$ \forall x_2 \forall x_3 \exists x_1 ( Q(x_1) \lor P(x_2) \lor R(x_3) )$

Direct overbinding gives: $x_3 < x_1$, rest arbitrary, hence:

$ \forall x_3 \exists x_1 \forall x_2 ( Q(x_1) \lor P(x_2) \lor R(x_3) )$ <- this you do not get with huang

$ \forall x_2 \forall x_3 \exists x_1 ( Q(x_1) \lor P(x_2) \lor R(x_3) )$

$ \forall x_3 \forall x_2 \exists x_1 ( Q(x_1) \lor P(x_2) \lor R(x_3) )$


\bigskip

\e{103b: length changes ``uniformly''} 

\begin{prooftree}
	\AxiomCm{\sig{Q(f(f(\ha x)))\lor P(f(\ha x))\lor R(\ha x)}}
	\AxiomCm{\p{\lnot Q(y_1)}}

	\RightLabelm{y_1\mapsto f(f(x))}
	\BinaryInfCm{P(f(x))\lor R(x)}

	\AxiomCm{\p{\lnot P(y_2)}}
	\RightLabelm{y_2\mapsto f(x)}
	\BinaryInfCm{ R(x)}

	\AxiomCm{\p{\lnot R(g(a))}}
	\RightLabelm{x\mapsto g(a)}
	\BinaryInfCm{\square}
\end{prooftree}

\begin{multicols}{2}


	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}

		\RightLabelm{y_1\mapsto f(f(x))}
		\BinaryInfCm{Q(f(f(x)))}

		\AxiomCm{\top}
		\RightLabelm{y_2\mapsto f(x)}
		\BinaryInfCm{ Q(f(f(x))) \lor P(f(x))}

		\AxiomCm{\top}
		\RightLabelm{x\mapsto g(a)}
		\BinaryInfCm{ Q(f(f(g(a)))) \lor P(f(g(a))) \lor R(g(a))}
	\end{prooftree}

	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}

		\BinaryInfCm{\exists x_1 Q(x_1)}

		\AxiomCm{\top}
		\BinaryInfCm{ \exists x_2 \exists x_1 ( Q(x_1) \lor P(x_2))}

		\AxiomCm{\top}
		\BinaryInfCm{ \forall x_3 \exists x_2 \exists x_1 ( Q(x_1) \lor P(x_2) \lor R(x_3))}
	\end{prooftree}

\end{multicols}

Huang and direct overbinding somewhat coincide as $x_2 < x_1$ in both cases, and $x_3 < x_1$ and $x_3 < x_2$

new algo:
	\begin{prooftree}
		\AxiomCm{\bot \mid Q(x_1)\lor P(x_2)\lor R(x)}
		\AxiomCm{\top \mid \lnot Q(y_1)}

		\RightLabelm{y_1\mapsto f(f(x))}
		\BinaryInfCm{Q(x_1) \mid P(x_2)\lor R( x)}

		\AxiomCm{\top \mid \lnot P(y_2)}
		\RightLabelm{y_2\mapsto f(x)}
		\BinaryInfCm{ Q(x_1) \lor P(x_2) \mid R(x)}

		\AxiomCm{\top \mid R(x_3)}
		\RightLabelm{x\mapsto g(a)}
		\BinaryInfCm{  Q(x_1) \lor P(x_2) \lor R(x_3) }
		\UnaryInfCm{ Q(f(f(g(a)))) \lor P(f(g(a))) \lor R(g(a))}
	\end{prooftree}
	\NB{in the last line, the terms corresponding to $x_1$ and $x_2$ change, but the interpolant stays the same}


\bigskip

\e{103c: Failed attempt: different variables, accidentally the same terms appear but no logical connection}



\begin{prooftree}
	\AxiomCm{\sig{P(a, x)}}
	
	\AxiomCm{\sig{\lnot Q(a)}}
	\AxiomCm{\p{\lnot P(y, f(\ha z)) \lor Q(\ha z)}}
	\RightLabelm{z\mapsto a}
	\BinaryInfCm{\lnot P(y, f(a))}

	\RightLabelm{y\mapsto a, x\mapsto f(a)}
	\BinaryInfCm{\square}

\end{prooftree}

\begin{multicols}{2}

	\begin{prooftree}
		\AxiomCm{\bot}

		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{z\mapsto a}
		\BinaryInfCm{\lnot Q(a)}

		\RightLabelm{y\mapsto a, x\mapsto f(a)}
		\BinaryInfCm{P(a, f(a)) \land \lnot Q(a)}

	\end{prooftree}
	Huang:
	\begin{prooftree}
		\AxiomCm{\bot}

		\AxiomCm{\bot}
		\AxiomCm{\top}
		\BinaryInfCm{\exists x_1 \lnot Q(x_1)}

		\BinaryInfCm{\exists x_1 \forall x_2 (P(x_1, x_2) \land \lnot Q(x_1))}


	\end{prooftree}

\end{multicols}

order required for $\Pi$
\bigskip

direct:
\begin{prooftree}
		\AxiomCm{\bot}

	\AxiomCm{\bot}
	\AxiomCm{\top}
	\RightLabelm{x_1 \sim a}
	\BinaryInfCm{\exists x_1 \lnot Q(x_1)}

	\RightLabelm{x_2 \sim a, x_3 \sim f(a); x_1 < x_3 }
	\BinaryInfCm{\exists x_1 \exists x_2 \forall x_3  (P(x_2, x_3) \land \lnot Q(x_1))}
	\UnaryInfCm{\text{OR:}~ \exists x_1 \forall x_3 \exists x_2  (P(x_2, x_3) \land \lnot Q(x_1))}

\end{prooftree}

\bigskip

invariant:
\begin{prooftree}
	\AxiomCm{\exists x_2 (P(x_2, x) \lor \bot )}

	\AxiomCm{\exists x_1 (Q(x_1) \lor \bot)}
	\AxiomCm{\forall x_3 ((\lnot P(y, \ha{x_3}) \lor Q(\ha z)) \lor \top)}
	\RightLabelm{x_1 \sim a}
	\BinaryInfCm{\exists x_1 \forall x_3 { \lnot P(y, \ha{x_3}) \lor  \lnot Q(\ha{x_1})}}

	\RightLabelm{x_2 \sim a, x_3 \sim f(a); x_1 < x_3 }
	\BinaryInfCm{\exists x_1 \exists x_2 \forall x_3  (P(x_2, x_3) \land \lnot Q(x_1))}
	\UnaryInfCm{\text{OR:}~ \exists x_1 \forall x_3 \exists x_2  (P(x_2, x_3) \land \lnot Q(x_1))}

\end{prooftree}
\bigskip

invariant in other resolution order
\begin{prooftree}
		\AxiomCm{\bot}

	\AxiomCm{\bot}
	\AxiomCm{\top}
	\RightLabelm{x_2 \sim a, x_3 \sim f(z)}
	\BinaryInfCm{Q(\ha z) \lor \exists x_2 \forall x_3 P(x_2, \ha{x_3})}

	\RightLabelm{x_1 \sim a; x_1 < x_3}
	\BinaryInfCm{\exists x_1 \exists x_2 \forall x_3  (P(x_2, x_3) \land \lnot Q(x_1))}
	\UnaryInfCm{\text{OR:}~ \exists x_1 \forall x_3 \exists x_2  (P(x_2, x_3) \land \lnot Q(x_1))}
\end{prooftree}
\bigskip


invariant if $\Sigma$ and $\Pi$ swapped:
\begin{prooftree}
		\AxiomCm{\bot}

	\AxiomCm{\top}
	\AxiomCm{\bot}
	\RightLabelm{x_1 \sim a}
	\BinaryInfCm{\lnot P(y, f(x_1)) \lor \forall x_1 Q(x_1)}

	\RightLabelm{x_2 \sim a, x_3 \sim f(a); x_1 < x_3 }
	\BinaryInfCm{\forall x_1 \forall x_2 \exists x_3  (\lnot P(x_2, x_3) \lor Q(x_1))}
	\UnaryInfCm{\text{OR:}~ \forall x_1 \exists x_3 \forall x_2  (\lnot P(x_2, x_3) \lor Q(x_1))}

\end{prooftree}

\bigskip


SECOND ATTEMPT:

\begin{prooftree}
	\AxiomCm{\sig{P(a)}}
	\AxiomCm{\sig{Q(z)}}

	\AxiomCm{\sig{\lnot S(a)}}
	\AxiomCm{\p{\lnot P(y) \lor \lnot Q(f(\ha x)) \lor S(\ha x)}}

	\RightLabelm{x\mapsto a}
	\BinaryInfCm{\lnot P(y) \lor \lnot Q(f(a))}

	\RightLabelm{z\mapsto f(a)}
	\BinaryInfCm{\lnot P(y) }

	\RightLabelm{y\mapsto a}
	\BinaryInfCm{\square}
\end{prooftree}

\begin{prooftree}
	\AxiomCm{\bot}
	\AxiomCm{\bot}

	\AxiomCm{\bot}
	\AxiomCm{\top}

	\RightLabelm{x\mapsto a}
	\BinaryInfCm{\lnot S(a)}

	\RightLabelm{z\mapsto f(a)}
	\BinaryInfCm{\lnot S(a) \land Q(f(a))}

	\RightLabelm{y\mapsto a}
	\BinaryInfCm{P(a) \land \lnot S(a) \land Q(f(a))}
\end{prooftree}

Huang:
\begin{prooftree}
	\AxiomCm{\bot}
	\AxiomCm{\bot}

	\AxiomCm{\bot}
	\AxiomCm{\top}

	\BinaryInfCm{\exists x_1 \lnot S(x_1)}

	\BinaryInfCm{ \exists x_1 \forall x_2 ( \lnot S(x_1) \land Q(x_2))}

	\BinaryInfCm{\exists x_1 \forall x_2 ( P(x_1) \land \lnot S(x_1) \land Q(x_2))}
\end{prooftree}

$ \forall x_1 \exists x_2 ( \lnot P(x_1) \lor S(x_1) \lor  \lnot Q(x_2) )$
\medskip

{ \bfseries similar fail }

{$\Ra$ anytime there is $P(a, f(a))$, either they have a dependency or they are not both differently colored (grey is uncolored) }

for the record, direct method anyway:

\begin{prooftree}
	\AxiomCm{\bot}
	\AxiomCm{\bot}

	\AxiomCm{\bot}
	\AxiomCm{\top}

	\RightLabelm{x\sim a}
	\BinaryInfCm{\exists x_1 \lnot S(x_1)}

	\RightLabelm{z\sim f(a); x_1 < x_2 }
	\BinaryInfCm{\exists x_1 \forall x_2 \lnot S(x_1) \land Q(x_2)}

	\RightLabelm{x_3 \sim a; x_3 \text{ need not be merged w } x_1 }
	\BinaryInfCm{\exists x_1 \forall x_2 \exists x_3 P(x_3) \land \lnot S(x_1) \land Q(x_2)}
\end{prooftree}





\clearpage 


%\begin{landscape}
\section*{Example: ordering on both ancestors where the merge forces a new ordering}


\e{202a -- canonical}

\begin{prooftree}
	\AxiomCm{ \sig{P(a,x_{564}) \lor R(y) } }
	\AxiomCm{ \p{\lnot P(\hc x, f\hc x)}}
	\RightLabel{\stackanchor{$x_1 \mapsto fa$}{$x\mapsto a$}}
	\BinaryInfCm{ R(y)}

	\AxiomCm{ \sig{Q(\ha{x_2}, g\ha{x_2}) \lor \lnot R(u) } }
	\AxiomCm{ \sig{\lnot S(a)}}
	\AxiomCm{ \p{\lnot Q(f\hb z, x_3) \lor S(\hb z)}}
	\RightLabelm{z \mapsto a}
	\BinaryInfCm{ \lnot Q(fa, x_3) }

	\RightLabel{\stackanchor{$x_2 \mapsto fa,$}{$x_3\mapsto gfa$}}
	\BinaryInfCm{ \lnot R(u) }	

	\BinaryInfCm{ \square}
\end{prooftree}


~

\begin{prooftree}
	\AxiomCm{ \bot }
	\AxiomCm{ \top}
	\RightLabel{\stackanchor{$x_1 \mapsto f(a)$}{$x\mapsto a$}}
	\BinaryInfCm{ P(a, f(a)) }

	\AxiomCm{ \bot }
	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\RightLabelm{z \mapsto a}
	\BinaryInfCm{ \lnot S(a) }

	\RightLabel{\stackanchor{$x_2 \mapsto f(a),$}{$x_3\mapsto g(f(a))$}}
	\BinaryInfCm{ Q(f(a), g(f(a))) \land \lnot S(a)}

	\BinaryInfCm{ P(a, f(a)) \lor ( Q(f(a), g(f(a))) \land \lnot S(a))}
\end{prooftree}


Huang
\begin{prooftree}
	\AxiomCm{ \bot }
	\AxiomCm{ \top}
	\BinaryInfCm{ \exists x_1 \forall x_2 P(x_1, x_2)) }

	\AxiomCm{ \bot }
	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\BinaryInfCm{ \exists x_1 \lnot S(x_1) }

	\BinaryInfCm{ \exists x_1 \forall x_2 \exists x_3 Q(x_2, x_3) \land \lnot S(x_1)}

	\BinaryInfCm{ \exists x_1 \forall x_2 \exists x_3  P(x_1, x_2) \lor ( Q(x_2, x_3)) \land \lnot S(x_1))}
\end{prooftree}



direct:

{\small
\begin{prooftree}
	\AxiomCm{ \bot }
	\AxiomCm{ \top}
	\RightLabel{\stackanchor{$x_1 \sim a, x_2 \sim fa$}{$ \hc{x_1 < x_2}$ } }
	\BinaryInfCm{ \exists x_1 \forall x_2 P(x_1, x_2)) }

	\AxiomCm{ \bot }
	\AxiomCm{ \bot }
	\AxiomCm{ \top }
	\RightLabel{{$x_3 \sim a$} }
	\BinaryInfCm{ \exists x_3 \lnot S(x_3) }

	\LeftLabel{\stackanchor{$x_3 \sim a, x_4 \sim fa, x_5 \sim gfa)$}{$\ha{x_3 < x_4}, \hb{x_4 < x_5 }$}}
	\BinaryInfCm{ \exists x_3 \forall x_4 \exists x_5 Q(x_4, x_5) \land \lnot S(x_3)}

	\RightLabel{\stackanchor{$x_3\mapsto x_1, x_4\mapsto x_2$}{$x_1 < x_2, x_2 < x_5 $}}
	\BinaryInfCm{ \exists x_1 \forall x_2 \exists x_5  P(x_1, x_2) \lor ( Q(x_2, x_5) \land \lnot S(x_5))}
\end{prooftree}
}


without merge in end: ($x_1<x_2, x_3<x_4, x_4<x_5$)

$ \underline{\exists x_1 \forall x_2}\, \underline{\exists x_3 \forall x_4 \exists x_5} \Big(  P(x_1, x_2) \lor ( Q(x_4, x_5) \land \lnot S(x_3)) \Big)$

$ \underline{\exists x_3 \forall x_4 \exists x_5}\, \underline{\exists x_1 \forall x_2}  \Big( P(x_1, x_2) \lor ( Q(x_4, x_5) \land \lnot S(x_3)) \Big)$

	(also interwoven ones appear to work)


	%\begin{landscape}
	\bigskip


combined presentation of 202a:
\vspace{-2em}
\begin{prooftree}
	\AxiomCm{ \bot \mid P(a, x_1) \lor R(y) }
	\AxiomCm{ \top \mid \lnot P(\arrowA x, f(\arrowB x)) } \drawAB
	\RightLabel{\stackanchor{$x_1 \mapsto f(a)$}{$x\mapsto a$}}
	\BinaryInfCm{ P(\arrowA a, f(\arrowB a)) \mid R(y) } \drawAB

	\AxiomCm{ \bot \mid Q(\arrowC x_2, g(\arrowD x_2)) \lor \lnot R(u) } \drawCD
	\AxiomCm{ \bot \mid \lnot S(a)}
	\AxiomCm{ \top \mid \lnot Q(f(\arrowF z), x_3) \lor S(\arrowE z)}\drawEF
	\RightLabelm{z \mapsto a}
	\BinaryInfCm{ \lnot S(\arrowE a) \mid \lnot Q(f(\arrowF a), x_3) } \drawEF

	\RightLabel{\stackanchor{$x_2 \mapsto f(a),$}{$x_3\mapsto g(f(a))$}}
	\BinaryInfCm{ Q(\arrowC f(\arrowF a), g(\arrowD f(a))) \land \lnot S(\arrowE a) \mid \lnot R(u)} \drawCD \drawEF

	\BinaryInfCm{ P(\arrowA a, f(\arrowB a)) \lor ( Q(\arrowC f(\arrowF a), g(\arrowD f(a))) \land \lnot S(\arrowE a)) \mid \square}
\drawCD \drawEF \drawAB
\end{prooftree}

combined presentation ground:

\begin{prooftree}
	\AxiomCm{ \bot \mid P(a, f(a)) \lor R(y) }
	\AxiomCm{ \top \mid \lnot P(a, f(a)) }
	\BinaryInfCm{ (P(a, f(a)) \land \top) \lor (\lnot P(a, f(a))\land \bot) \mid R(y) }

	\AxiomCm{ \bot \mid Q(f(a), g(f(a))) \lor \lnot R(u) }
	\AxiomCm{ \bot \mid \lnot S(a)}
	\AxiomCm{ \top \mid \lnot Q(f(a), g(f(a))) \lor S(a)}
	\BinaryInfCm{ \lnot S(a) \mid \lnot Q(f(a), g(f(a))) }

	\BinaryInfCm{ Q(f(a), g(f(a))) \land \lnot S(a) \mid \lnot R(u)}

	\BinaryInfCm{ P(a, f(a)) \lor ( Q(f(a), g(f(a))) \land \lnot S(a)) \mid \square}
\end{prooftree}

combined presentation ground with direct method but only $\Delta$-terms removed :

\begin{prooftree}
	\AxiomCm{ \bot \mid P(a, f(a)) \lor R(y) }
	\AxiomCm{ \top \mid \lnot P(a, f(a)) }
	\BinaryInfCm{ (P(a, x_2) \land \top) \lor (\lnot P(a, x_2)\land \bot) \mid R(y) }

	\AxiomCm{ \bot \mid Q(f(a), g(f(a))) \lor \lnot R(u) }
	\AxiomCm{ \bot \mid \lnot S(a)}
	\AxiomCm{ \top \mid \lnot Q(f(a), g(f(a))) \lor S(a)}
	\BinaryInfCm{ \lnot S(a) \mid \lnot Q(f(a), g(f(a))) }

	\BinaryInfCm{ Q(x_4, g(x_4)) \land \lnot S(a) \mid \lnot R(u)}

	\BinaryInfCm{ P(a, x_2) \lor ( Q(x_4, g(x_4)) \land \lnot S(a)) \mid \square}
\end{prooftree}


combined presentation ground with direct method:

\begin{prooftree}
	\AxiomCm{ \bot \mid P(a, f(a)) \lor R(y) }
	\AxiomCm{ \top \mid \lnot P(a, f(a)) }
	\BinaryInfCm{ \exists x_1 \forall x_2 ( P(x_1, x_2) \land \top) \lor (\lnot P(x_1, x_2)\land \bot) \mid R(y) }

	\AxiomCm{ \bot \mid Q(f(a), g(f(a))) \lor \lnot R(u) }
	\AxiomCm{ \bot \mid \lnot S(a)}
	\AxiomCm{ \top \mid \lnot Q(f(a), g(f(a))) \lor S(a)}
	\BinaryInfCm{ \exists x_3 \lnot S(x_3) \mid \lnot Q(f(a), g(f(a))) }

	\BinaryInfCm{ \exists x_3 \forall x_4 \exists x_5 (Q(x_4, x_5)) \land \lnot S(x_3)) \mid \lnot R(u)}

	\BinaryInfCm{ \exists x_1 \forall x_2 \exists x_3 \forall x_4 \exists x_5 ( P(x_1, x_2) \lor ( Q(x_4, x_5)) \land \lnot S(x_3)) \mid \square}
\end{prooftree}




%\end{landscape}


\clearpage

\e{203a -- some alternations}

\begin{prooftree}
	\AxiomCm{ \p{\lnot S(x_1)}}

	\AxiomCm{\p{ \lnot R(a)}}

	\AxiomCm{\sig{ R(\arrowA x) \lor  \lnot P(f(\arrowB x)) \drawAB}}
	\AxiomCm{ \p{ P(\arrowA z) \lor Q(g(\arrowB z)) \drawAB} }
	\RightLabelm{z\mapsto f(x)}
	\BinaryInfCm{ R(x) \lor Q(g(f(x)))}

	\AxiomCm{ \sig{ \lnot Q(\arrowA y) \lor S(h(\arrowB y)) \drawAB}}
	\RightLabelm{y\mapsto g(f(x))}
	\BinaryInfCm{ R(x) \lor S(h(g(f(x))))}

	\RightLabelm{x\mapsto a}
	\BinaryInfCm{S(h(g(f(a))))}

	\RightLabelm{x_1\mapsto h(g(f(a)))}
	\BinaryInfCm{\square}

\end{prooftree}

~

\begin{prooftree}

	\AxiomCm{ \top}

	\AxiomCm{\top}

	\AxiomCm{\bot}
	\AxiomCm{ \top}
	\RightLabelm{z\mapsto f(x)}
	\BinaryInfCm{ \lnot P(f(x)) }

	\AxiomCm{ \bot }
	\RightLabelm{y\mapsto g(f(x))}
	\BinaryInfCm{ \lnot Q(g(f(\arrowB x))) \land \lnot P(f(\arrowA x)) \drawAB }

	\RightLabelm{x\mapsto a}
	\BinaryInfCm{ \lnot Q(g(f(\arrowB a))) \land \lnot P(\arrowA f(\arrowD a)) \lor R(\arrowC a) \drawAB\drawCD}

	\RightLabelm{x_1\mapsto h(g(f(a)))}
	\BinaryInfCm{  \lnot Q(\arrowE g(\arrowB f(a))) \land \lnot P(\arrowA\drawAB f(\arrowD a)) \lor R(\arrowC\drawCD a) \lor S(h(\arrowF g(f(a)))) \drawEF }

\end{prooftree}

Huang:
\begin{prooftree}
	\AxiomCm{ \top}

	\AxiomCm{\top}

	\AxiomCm{\bot}
	\AxiomCm{ \top}
	\BinaryInfCm{ \exists x_1 \lnot P(x_1) }

	\AxiomCm{ \bot }
	\BinaryInfCm{ \exists x_1 \forall x_2 (\lnot Q(x_2) \land \lnot P(x_1) )}

	\BinaryInfCm{ \forall x_0 \exists x_1 \forall x_2 (\lnot Q(x_2) \land \lnot P(x_1) \lor R(x_0) )}

	\BinaryInfCm{ \forall x_0 \exists x_1 \forall x_2 \exists x_3 ( \lnot Q(x_2) \land \lnot P(x_1) \lor R(x_0) \lor S(x_3) ) }

\end{prooftree}

Direct:
\begin{prooftree}

	\AxiomCm{ \top}

	\AxiomCm{\top}

	\AxiomCm{\bot}
	\AxiomCm{ \top}
	\RightLabelm{x_1 \sim f(x)}
	\BinaryInfCm{ \exists x_1 \lnot P(x_1) }

	\AxiomCm{ \bot }
	\RightLabel{{$x_2\sim g(f(x)); x_1 < x_2$}}
	\BinaryInfCm{ \exists \arrowA x_1 \forall \arrowB x_2 (\lnot Q(x_2) \land \lnot P(f(x))) \drawAB }

	\RightLabelm{x_0 \sim a; x_0 < x_1, x_0 < x_2}
	\BinaryInfCm{ \forall \arrowA x_0 \exists \arrowB\,\arrowC x_1 \forall \arrowD x_2 \drawAB\drawCD (\lnot Q(x_2) \land \lnot P(x_1) \lor R(x_0) )}

	\RightLabelm{x_3\sim h(g(f(a))); x_0 < x_3, x_1 < x_3, x_2 < x_3}
	\BinaryInfCm{ \forall \arrowA x_0 \exists \arrowB\drawAB\,\arrowC x_1 \forall \arrowD\drawCD\,\arrowA x_2 \exists \arrowB\drawAB x_3 ( \lnot Q(x_2) \land \lnot P(x_1) \lor R(x_0) \lor S(x_3) ) }

\end{prooftree}

\largered{all combinations of quantifiers work, arrows not relevant}

$\AIde$:

\mycols[5]{
	$x_2 \sim g(z))$&
	$x_5 \sim g(f(x))$
}
\smallskip

\begin{prooftree}

	\AxiomCm{ \top \mid S(u)}

	\AxiomCm{\top \mid R(x_0) }

	\AxiomCm{\bot \mid R(x) \lor \lnot P(f(x))}
	\AxiomCm{ \top \mid P(z) \lor Q(x_2)}
	\BinaryInfCm{ \lnot P(f(x)) \mid R(x) \lor Q(x_2)  }

	\AxiomCm{ \bot \mid \lnot Q(y) \lor S(h(y)) }
	\BinaryInfCm{ Q(x_2) \land \lnot P(f(x)) \mid R(x) \lor S(h(x_2))  }

	\BinaryInfCm{
	\big(Q(x_2) \land \lnot P(f(x_0))\big) \lor R(x_0) \mid S(h(x_2))  }

	\BinaryInfCm{ 
	\big(Q(x_2) \land \lnot P(f(x_0))\big) \lor R(x_0) \lor S(h(x_2))  }

\end{prooftree}


$ \forall x_0 \forall x_2 \forall x_5 \big(\lnot Q(x_2) \land \lnot P(f(x_0))\big) \lor R(x_0) \lor S(h(x_2))$ 




\e{203b -- many $\Sigma$-literals, coloring per occurrence}

\begin{prooftree}
	\AxiomCm{ \p{\lnot S(x_1)}}

	\AxiomCm{\p{ \lnot R(a)}}

	\AxiomCm{\sig{ R(\arrowA x) \lor  \lnot P(f(\arrowB x)) \drawAB}}
	\AxiomCm{ \sig{ P(\arrowA z) \lor Q(g(\arrowB z)) \drawAB} }
	\RightLabelm{z\mapsto fx}
	
	\BinaryInfCm{ R(x) \lor Q(gfx) }
	
	\AxiomCm{ \sig{ \lnot Q(\arrowA y) \lor S(h(\arrowB y)) \drawAB}}
	\RightLabelm{y\mapsto gfx}

	\BinaryInfCm{ R(x) \lor S(hgfx) }

	\RightLabelm{x\mapsto a}

	\BinaryInfCm{  S(hgfa) }

	\RightLabelm{x_1\mapsto hgfa}
	\BinaryInfCm{ \square }
\end{prooftree}

~

\begin{prooftree}
	\AxiomCm{ \top}

	\AxiomCm{\top}

	\AxiomCm{\bot}
	\AxiomCm{ \bot}
	\RightLabelm{z\mapsto fx}
	
	\BinaryInfCm{ \bot}
	
	\AxiomCm{ \bot}
	\RightLabelm{y\mapsto gfx}

	\BinaryInfCm{ \bot} 

	\RightLabelm{x\mapsto a}

	\BinaryInfCm{  R(a) }

	\RightLabelm{x_1\mapsto hgfa}
	\BinaryInfCm{ S(hgfa) \lor R(a) }
\end{prooftree}

$\ra$ $\forall x_1 \exists x_2 ( R(x_1) \lor S(x_2) )$

\clearpage

\section*{Example where variables are not the outermost symbol but order is still relevant}


\e{204a}

$\Sigma = \{ P(f(\arrowA x), g(f(\arrowB x))) \}\drawAB$

$\Pi= \{ P(f(a), y) \} $

$\Ra \forall \arrowA x_1 \exists \arrowB x_2\drawAB P(f(x_1), x_2) $ 


\e{204b}

$\Sigma = \{ P(f^5(\arrowA x), g(f(\arrowB x))) \}\drawAB$

$\Pi= \{ P(f^5(a), y) \} $

$\Ra \forall \arrowA x_1 \exists \arrowB x_2\drawAB P(f^5(x_1), x_2) $ 



\clearpage 
\section*{example with aufschaukelnde unification, such that direction of arrow isn't clear}
\e{205a}
{\LARGE

situation not critical here 

}
{\footnotesize

\vspace{-1em}
\begin{prooftree}
	\AxiomCm{\p{P(ff\hb y, g\hb y)}}

	\AxiomCm{\sig{\lnot P(\ha x, y) \lor Q(\ha x)}}

	\AxiomCm{\sig{\lnot R(a)}}
	\AxiomCm{\p{\lnot Q(ff\arrowB{\hc z}) \lor R\arrowA{\hc z}}\drawAB}

	\RightLabelm{z \mapsto a}
	\BinaryInfCm{\lnot R(a) \mid \lnot Q(ffa)}

	\RightLabelm{x \mapsto ffa}
	\BinaryInfCm{\lnot R(a) \land Q(ffa) \mid \lnot P(ffa, y) }

	\RightLabelm{y \mapsto a}
	\BinaryInfCm{ (\lnot R(a) \land Q(ffa)) \lor \lnot P(ffa, ga) }
\end{prooftree}

direct

\begin{prooftree}
	\AxiomCm{\p{P(ff\hb y, g\hb y)}}

	\AxiomCm{\sig{\lnot P(\ha x, y) \lor Q(\ha x)}}

	\AxiomCm{\sig{\lnot R(a)}}
	\AxiomCm{\p{\lnot Q(ff\hc z) \lor R\hc z}}

	\RightLabelm{z \mapsto a}
	\BinaryInfCm{\exists \arrowA x_1 \lnot R(x_1) \mid \lnot Q(ff\arrowB a)\drawAB}

	\RightLabelm{x \mapsto ffa}
	\BinaryInfCm{ \exists \arrowA x_1 \forall \arrowB x_2 (\lnot R(x_1) \land Q(x_2)) \mid \lnot P(ffa, u) \drawAB}

	\RightLabelm{y \mapsto a, u\mapsto ga}
	\BinaryInfCm{\exists \arrowA x_1 \forall \arrowB\,\arrowAB x_2 \forall \arrowBA\drawAABB x_3  ((\lnot R(x_1) \land Q(x_2)) \lor \lnot P(x_2, x_3) ) \drawAB}
\end{prooftree}


ground:
\begin{prooftree}
	\AxiomCm{\p{P(ff\hb a, g\hb a)}}

	\AxiomCm{\sig{\lnot P(\ha{ffa}, y) \lor Q(\ha {ffa})}}

	\AxiomCm{\sig{\lnot R(a)}}
	\AxiomCm{\p{\lnot Q(ff\arrowB{\hc a}) \lor R\arrowA{\hc a}}\drawAB}

	\BinaryInfCm{\lnot R(\arrowA a) \mid \lnot Q(ff\arrowB a)\drawAB}

	\BinaryInfCm{\lnot R(\arrowA a) \land Q(ff\arrowB\,\arrowAB a) \mid \lnot P(ff\arrowBA a, a) \drawAB \drawAABB}

	\BinaryInfCm{ (\lnot R(\arrowE a) \land Q(\arrowBA ff\arrowF a)) \lor \lnot P(ff\arrowAB\,\arrowDC a, g\arrowCD a) \drawEF \drawAABB\drawCCDD}
\end{prooftree}

}
{ \tiny

arrow lemma:
$x_1 \sim ffy$,
$x_2 \sim gy$,
$y_3 \sim a$
$x_4 \sim ffz$,
$x_5 \sim ffa$,
$y_6 \sim a$,
\begin{prooftree}
	\AxiomCm{\forall x_1 \forall x_4 (\p{P(x_1, x_2)} \mid \top)}

	\AxiomCm{\sig{\lnot P(\ha x, y) \lor Q(\ha x)}\mid \bot}

	\AxiomCm{\sig{\exists y_3 ( \lnot R(y_3)}\mid \bot)}
	\AxiomCm{\forall x_4(\p{\lnot Q(x_4) \lor R\arrowA{\hc z}}\mid \bot)}

	\RightLabelm{z \mapsto a}
	\BinaryInfCm{\exists y_3 \forall x_4 ( (\lnot R(y_3) \land \top ) \lor \dashuline{(R(a) \land \bot)} \mid \lnot Q(x_4))}

	\RightLabelm{x \mapsto ffa}
	\BinaryInfCm{\exists y_3 \forall x_4 ( (\lnot Q(x_4 \land \bot)) \lor (Q(x)\sigma \land \lnot R(y_3) ) \mid \lnot P(x, y)\sigma ) }
	\noLine
	\UnaryInfCm{\exists y_3 \forall x_4 ( (Q(ffa) \land \lnot R(y_3) ) \mid \lnot P(ffa, y) ) \quad(*)} 
	\noLine
	\UnaryInfCm{\exists y_3 \forall x_4 \forall x_5 ( (Q(x_5) \land \lnot R(y_3) ) \mid \lnot P(x_5, y) )} 

	\RightLabelm{y \mapsto a}
	\BinaryInfCm{  (\lnot P(x_5, y) \land \top) \lor (P(x_1, x_2) \land (Q(x_5) \land \lnot R(y_3))) }
	\noLine
	\UnaryInfCm{  (\lnot P(x_5, a) \land \top) \lor (P(x_1, x_2) \land (Q(x_5) \land \lnot R(y_3))) }
	\noLine
	\UnaryInfCm{ \forall x_1 \forall x_2 \exists y_3 \forall x_4 \forall x_5 \forall x_6  (\lnot P(x_5, y_6) \land \top) \lor (P(x_1, x_2) \land (Q(x_5) \land \lnot R(y_3))) }
\end{prooftree}
$(*)$ ``luckily'', same overbinding for $ffa$, so this works

dashed underline: problem, but does not cause issues here.
}
	\e{205b $\sim$ 205a, but simpler}

	Suppose $P$ occurs somewhere in $\Sigma$ (result not that optimal in this setting, but correct)

	not nice for proving, $\lnot R(a)$ is a nice interpolant already

\begin{prooftree}
	\AxiomCm{\p{P(ff\hb y, g\hb y)}}


	\AxiomCm{\sig{\lnot R(a)}}
	\AxiomCm{\p{\lnot P(ff\arrowB{\hc z}, x) \lor R\arrowA{\hc z}}\drawAB}

	\RightLabelm{z \mapsto a}
	\BinaryInfCm{\lnot R(a) \mid \lnot P(ffa, x)}

	\RightLabelm{x \mapsto ga, y \mapsto a}
	\BinaryInfCm{ \lnot R(a) \lor \lnot P(ffa, ga)  \mid \square }
\end{prooftree}

~

\begin{prooftree}
	\AxiomCm{\top \mid \p{P(ff\arrowAB\hb y, g\arrowBA \hb y)} \drawAABB}

	\AxiomCm{\bot \mid \sig{\lnot R(a)}}
	\AxiomCm{\top \mid \p{\lnot P(ff\arrowB{\hc z}, x) \lor R\arrowA{\hc z}}\drawAB}

	\BinaryInfCm{\exists \arrowA x_1 \lnot R(x_1) \mid \lnot P(ff\arrowB a, x) \drawAB}

	\BinaryInfCm{ \exists \arrowA x_1 \forall \arrowB\,\arrowAB \drawAB x_2 \forall \arrowBA \drawAABB x_3  \lnot R(x_1) \lor \lnot P(x_2, x_3)  \mid \square }
\end{prooftree}


\begin{prooftree}
	\AxiomCm{\forall \arrowAB x_7 \forall \arrowBA x_8 \Big( \top \mid \p{P(x_7, x_8) \Big)} \drawAABB}

	\AxiomCm{ \exists x_1 \Big( \bot \mid \sig{\lnot R(x_1)}\Big)}
	\AxiomCm{ \forall x_5 \Big(\top \mid \p{\lnot P(\arrowB x_5, x) \lor R\arrowA{z}}\drawAB\Big)}

	\BinaryInfCm{\exists \arrowA x_1\,\forall \arrowB x_5 \Big(\lnot R(x_1) \mid \lnot P(x_5, x) \drawAB\Big)}

	\BinaryInfCm{ \exists \arrowA x_1 \forall \arrowB\,\arrowAB \drawAB x_2 \forall \arrowBA \drawAABB x_3  \lnot R(x_1) \lor \lnot P(x_2, x_3)  \mid \square }
	\noLine
	\UnaryInfC{ in $\aiu$, $x_2$ and $x_3$ win since these are the ``actual'' terms}

\end{prooftree}

last step in slow motion:

\begin{multicols}{6}
$\colterm{1} = a$

$\colterm{2} = f(f(a))$

$\colterm{3} = g(a)$

$\colterm{5} = f(f(z))$

$\colterm{7} = f(f(y))$

$\colterm{8} = g(y)$
\end{multicols}

$ \AImatrix(\cdot) = $

$= \lifboth{ \Big( \Big( P(x_7, x_8) \land \lnot R(x_1) \Big) \lor \Big(\lnot P(x_5, x) \land \top\Big) \Big) \sigma} \tau  $

$=  \Big( P(x_7, x_8) \land \lnot R(x_1) \Big)\tau \lor \Big(\lnot P(x_5, x_3) \land \top\Big) \Big) \tau  $

$\aiu(x_7, x_5) = \{x_7\mapsto x_2, x_5\mapsto x_2\}$

$\aiu(x_8, x_3) = \{x_8\mapsto x_3, x_8\mapsto x_3\}$

$\exists x_1  R(x_1)$

$\exists x_1 \forall x_2 \forall x_3 ( R(\arrowA x_1) \lor \lnot P(\arrowB\, \arrowAB x_2, \arrowBA x_3) ) \drawAABB \drawAB$
\clearpage 

\section*{example to demonstrate that literals being resolved upon have to be overbound with the same variable}

\e{206a}

\begin{prooftree}
	\AxiomCm{\p{R(f(x))}}
	\AxiomCm{\sig{\lnot R(y) \lor P(y)}}
	\BinaryInfCm{ (\lnot R(x_3) \land \top) \lor (R(x_3) \land \bot) \mid P(x_3)}

	\AxiomCm{\p{\lnot P(f(z)) \lor S(z)}}
	\AxiomCm{\sig{\lnot S(a)}}
	\BinaryInfCm{ (\lnot S(y_2) \land \top ) \lor (S(y_2) \land \bot) \mid \lnot P(x_4) }

	\BinaryInfCm{ (\forall x_3) \exists y_2 \forall x_4 (\forall x_3) \Big((\lnot P(x_4) \land \lnot R(x_3)) \lor (P(x_3) \land S(y_2)) \Big)}

\end{prooftree}

\begin{tabular}{p{.48\textwidth}|p{.48\textwidth}}
	Gist of this example: $P(f(x))$ is lifted on the left, but $P(f(a))$ on the right. So it's $P(x_3)$ vs $P(x_4)$, but both of them have to have the same variable.

	$R(x_3) \in \AImatrix(C_7)$

	$P(x_3) \in \AIclause(C_7)$

	$P(x_4) \in \AIclause(C_8)$

	$\Sigma \entails
	(\forall x_3) \exists y_2 \forall x_4 (\forall x_3) \Big((\lnot P(x_4) \land \lnot R(x_3)) \lor (P(x_3) \land S(y_2)) \Big)$


	$\Sigma \entails
	(\forall x_3)  \forall x_4 (\forall x_3) \Big((\lnot P(x_4) \land \lnot R(x_3)) \lor P(x_3) \Big)$

	$\Sigma \notentails
	(\lnot P(1) \land \lnot R(0)) \lor P(0) $ 
	\comm{if $P \sim \{1\}$ and $R \sim \{0\}$}

	we know that for original clauses $l$ and $l'$ of $P(x_4)$ and $P(x_3)$, $l\sigma = l'\sigma$

	hence same color, and can use different var as same value works.
	&
	inductive hypothesis:

	$\Gamma \entails \top \lor R(x_3)$

	$\Gamma \entails \bot \lor \lnot R(y) \lor P(y)$

$\Gamma \entails (\lnot R(x_3) \land \top) \lor (R(x_3) \land \bot) \lor P(x_3) \spa\equiv \lnot R(x_3) \lor P(x_3) $
 \line(1,0){250}
\newline
$\Gamma \entails \top \lor \lnot P(x_4) \lor S(z)$

$\Gamma \entails \bot \lor \lnot S(a)$

$\Gamma \entails (\lnot S(a) \land \top ) \lor (S(a) \land \bot) \lor \lnot P(x_4) \spa\equiv \lnot S(a)\lor \lnot P(x_4)$
 \line(1,0){250}
\newline
$\Gamma \entails (\lnot P(x_3) \land \lnot R(x_3)) \lor (P(x_3) \land S(a)) $

\end{tabular}

\e{206b}

\wrong{if a variable $x_3$ occurs, it always refers to $f(x)$, so it is always substituted to a particular value and cannot become $f(a)$ and $f(b)$ in the same clause as just the unifier $\sigma$ is used.

\begin{prooftree}
	\AxiomCm{\p{R(f(x), f(x))}}
	\AxiomCm{\sig{\lnot R(y, u) \lor P(y, u)}}
	\BinaryInfCm{ (\lnot R(x_3, x_3) \land \top) \lor (R(x_3, x_3) \land \bot) \mid P(x_3, x_3)}

	\AxiomCm{\p{\lnot P(f(z), f(v)) \lor S(z, v)}}
	\AxiomCm{\sig{\lnot S(a, b)}}
	\BinaryInfCm{ (\lnot S(y_2, y_6) \land \top ) \lor (S(y_2, y_6) \land \bot) \mid \lnot P(x_4, x_7) }

	\BinaryInfCm{ (\forall x_3) \exists y_2 \forall x_4 (\forall x_3) \Big((\lnot P(x_4) \land \lnot R(x_3)) \lor (P(x_3) \land S(y_2)) \Big)}

\end{prooftree}

}

\clearpage 

\section*{problems due to $x_j$ not referring to actual term}

\e{208a}

{\huge

	\bfseries
	\color{red}

	WRONG: variable $x$ is used in two clauses

}

\begin{prooftree}
	\AxiomCm{\p{P(f(x)) \lor Q(x) \lor R(u)}}
	\AxiomCm{\sig{\lnot Q(a)}}
	\BinaryInfCm{P(f(a)) \lor R(u)}

	\AxiomCm{\p{P(f(x)) \lor Q(x) \lor \lnot R(u)}}
	\AxiomCm{\sig{\lnot Q(b)}}
	\BinaryInfCm{P(f(b)) \lor \lnot R(u)}

	\BinaryInfCm{P(f(a)) \lor P(f(b))}

	\AxiomCm{\p{\lnot P(f(x)) \lor S(x) }}
	\AxiomCm{\sig{\lnot S(a)}}
	\BinaryInfCm{\lnot P(f(a))}

	\BinaryInfCm{P(f(b))} 
\end{prooftree}

~

\begin{prooftree}
	\AxiomCm{\top \mid {P(x_1) \lor Q(x) \lor R(u)}}
	\AxiomCm{\bot \mid {\lnot Q(y_2)}}
	\BinaryInfCm{\lnot Q(y_2) \mid P(x_1) \lor R(u)}

	\AxiomCm{\top \mid {P(x_1) \lor Q(x) \lor R(u)}}
	\AxiomCm{\bot \mid {\lnot Q(y_4)}}
	\BinaryInfCm{\lnot Q(y_4) \mid P(x_1) \lor R(u)}

	\BinaryInfCm{ \lnot Q(y_2) \land \lnot Q(y_4) \mid  P(x_1) \lor P(x_1)}

	\AxiomCm{\top \mid \p{\lnot P(x_1) \lor S(x) }}
	\AxiomCm{\top \mid \sig{\lnot S(y_2)}}
	\BinaryInfCm{\lnot S(y_2) \mid \lnot P(x_1)}

	\BinaryInfCm{ (\lnot P(x_5) \land \lnot Q(y_2) \land \lnot Q(y_4) )
	\spa\lor (P(x_5) \land \lnot S(y_2)) \spa{|} P(x_5)}
	\noLine
	\UnaryInfC{\NB{as the $x_1$ in the literal is actually $f(a)$, this way, all $x_1$ become $x_5$, but the other one is supposed to stand for $f(b)$}}


\end{prooftree}

{\huge

	\bfseries
	\color{green}

	ACTUALLY:

}

\begin{prooftree}
	\AxiomCm{\p{P(f(x)) \lor Q(x) \lor R(u)}}
	\AxiomCm{\sig{\lnot Q(a)}}
	\BinaryInfCm{P(f(a)) \lor R(u)}

	\AxiomCm{\p{P(f(x')) \lor Q(x') \lor \lnot R(u')}}
	\AxiomCm{\sig{\lnot Q(b)}}
	\BinaryInfCm{P(f(b)) \lor \lnot R(u')}

	\BinaryInfCm{P(f(a)) \lor P(f(b))}

	\AxiomCm{\p{\lnot P(f(x'')) \lor S(x'') }}
	\AxiomCm{\sig{\lnot S(a)}}
	\BinaryInfCm{\lnot P(f(a))}

	\BinaryInfCm{P(f(b))} 
\end{prooftree}

~

\begin{prooftree}
	\AxiomCm{\top \mid {P(x_1) \lor Q(x) \lor R(u)}}
	\AxiomCm{\bot \mid {\lnot Q(y_2)}}
	\BinaryInfCm{\lnot Q(y_2) \mid P(x_1) \lor R(u)}

	\AxiomCm{\top \mid {P(x_2) \lor Q(x) \lor R(u)}}
	\AxiomCm{\bot \mid {\lnot Q(y_4)}}
	\BinaryInfCm{\lnot Q(y_4) \mid P(x_2) \lor R(u)}

	\BinaryInfCm{ \lnot Q(y_2) \land \lnot Q(y_4) \mid  P(x_1) \lor P(x_2)}

	\AxiomCm{\top \mid \p{\lnot P(x_3) \lor S(x) }}
	\AxiomCm{\top \mid \sig{\lnot S(y_2)}}
	\BinaryInfCm{\lnot S(y_2) \mid \lnot P(x_3)}

	\BinaryInfCm{ (\lnot P(x_5) \land \lnot Q(y_2) \land \lnot Q(y_4) )
	\spa\lor (P(x_5) \land \lnot S(y_2)) \spa{|} P(x_2)}
	\noLine
	\UnaryInfC{ \NB{$\aiu(P(x_1), P(x_3)) = \{x_1 \mapsto x_5, x_3\mapsto x_5\}$}}


\end{prooftree}

Hence a term with a free variable in a clause can never be lifted by the same variable as a term in another clause.

If two terms in the same clause are lifted with a certain variable, they are bound together in the derivation anyway.


\clearpage 

\section*{clause used multiple times} 

\e{209a}

\begin{prooftree}
	\AxiomCm{ \sig{P(a)} }
	\AxiomCm{ \sig{\lnot Q(a)} }
	\AxiomCm{ \p{\lnot P(x) \lor P(f(x)) \lor Q(y)} }
	\BinaryInfCm{ \lnot P(x) \lor\arrowA P(f(x)) }
	\BinaryInfCm{ P(f(a)) }
	\AxiomCm{ \arrowB\drawAB }
	\BinaryInfCm{ P(f(f(a))) }
	\AxiomCm{ \p{\lnot P(f(f(z)))}}
	\BinaryInfCm{ \square} 
\end{prooftree}

\NB{we need to rename lifting variables, possibly rename all lifting variables which refer to a term which contains variables (an actual implementation might do this more efficiently, i.e.\ not always)} 

~

\begin{prooftree}
	\AxiomCm{ \bot \mid {P(a)} }
	\AxiomCm{ \bot \mid Q(a) }
	\AxiomCm{ \top \mid {\lnot P(x) \lor P(x_1) \lor Q(y)} }
	\BinaryInfCm{ Q(a) \mid \lnot P(x) \lor\arrowA P(x_1) }
	\BinaryInfCm{ P(a) \land Q(a) \mid  P(x_1)  }
	\noLine
	\UnaryInfC{\NB{$x_1$ used to refer to $f(x)$, now: $f(a)$}}
	\AxiomCm{ \arrowB\drawAB Q(a) \mid \lnot P(x') \lor P(x_1')}
	\BinaryInfCm{( \lnot P(x_1) \land P(a)\land Q(a) ) \spa\lor (P(x_1) \land Q(a)) \spa\mid  P(x_1') }
	\AxiomCm{ \top \mid {\lnot P(x_2)}}
	\BinaryInfCm{ \Big(\lnot P(x_3) \land  (\lnot P(x_1) \land P(a)\land Q(a) ) \spa\lor (P(x_1) \land Q(a))\Big) \spa \lor P(x_3)  \mid  \square} 
	\noLine
	\UnaryInfCm{\aiu(x_1', x_2) = \{x_1' \mapsto \lifboth{f(f(a))},
		x_2 \mapsto \lifboth{f(f(a))}}
\end{prooftree}

$ \Big(\lnot P(x_3) \land  (\lnot P(x_1) \land P(a)\land Q(a) ) \spa\lor (P(x_1) \land Q(a))\Big) \spa     \lor P(x_3)$

$\equiv
\Big(Q(a) \land \Big( (\lnot P(x_1) \land P(a) ) \spa\lor P(x_1) \Big)\Big) \spa     \lor P(x_3)$

$\Sigma \checkmark$

negated: 
$\Big(\lnot Q(a) \lor \Big( (P(x_1) \lor \lnot P(a) ) \spa\land \lnot P(x_1) \Big)\Big) \spa     \land \lnot P(x_3)$

$\equiv
\Big(\lnot Q(a) \lor \Big(  \lnot P(a) \spa\land \lnot P(x_1) \Big)\Big) \spa     \land \lnot P(x_3)$

$\Pi \checkmark$

(none of the $P(f^n(x))$, $n\leq 2$, are allowed to be true in a model of $\Phi$) 

\clearpage 

\section*{example with multicolored term without arrow}

\e{210a}
\begin{prooftree}
	\AxiomCm{ \sig{P(f(x)) \lor Q(x)}}
	\AxiomCm{ \p{\lnot Q(y) \lor R(g(y)) }}
	\BinaryInfCm{ P(f(x)) \lor R(g(x)) }
	\AxiomCm{ \p{\lnot R(g(a)) }}
	\BinaryInfCm{ P(f(a)) }
\end{prooftree}

$\AI^\Delta$:

\begin{prooftree}
	\AxiomCm{ \sig{P(f(x)) \lor Q(x)}}
	\AxiomCm{ \p{\lnot Q(y) \lor R(x_2)) }}
	\BinaryInfCm{ P(f(x)) \lor R(x_2)) }
	\AxiomCm{ \p{\lnot R(x_3) }}
	\BinaryInfCm{ P(f(x_4)) }
\end{prooftree}

~

\begin{prooftree}
	\AxiomCm{\exists x_1 \mid \bot \mid \sig{P(x_1) \lor Q(x)}}
	\AxiomCm{ \forall x_2 \mid \top \mid  \p{\lnot Q(y) \lor R(x_2) }}
	\BinaryInfCm{ \stackrel{\exists x_1}{\forall x_2} \mid Q(x) \mid P(x_1) \lor R(x_2) }
	\AxiomCm{ \forall x_3 \mid \top\mid \p{\lnot R(x_3) }}
	\BinaryInfCm{\forall x_4 \stackrel{\exists x_1}{\forall x_3}  \mid R(x_3) \lor Q(x_4) \mid  P(x_1) }
\end{prooftree}

Gist of this example: a variable is contained once in a $\Gamma$- and once in a $\Delta$-term in the same clause. Then we can unify basically any foreign term into the differently colored terms.

Here, the arrow actually exists since $Q(x)$ is in the interpolant.

\e{210b -- framework to get other (unrelated) terms into the interpolant}
\begin{prooftree}
	\AxiomCm{ \sig{P(f(x)) \lor Q(x)}}
	\AxiomCm{ \p{\lnot Q(y) \lor R(g(y)) }}
	\BinaryInfCm{ P(f(x)) \lor R(g(x)) }

	\AxiomCm{ \p{\lnot R(g(z)) \lor T(z)}}

	\AxiomCm{ \sig{\lnot S(z') \lor\lnot T(z')} }
	\AxiomCm{ \p{\lnot S(a)} }
	\BinaryInfCm{ \lnot T(a)}

	\BinaryInfCm{ \lnot R(g(a)) }


	\BinaryInfCm{ P(f(a)) }
\end{prooftree}


$\AI^\Delta:$

\begin{prooftree}
	\AxiomCm{ \sig{P(f(x)) \lor Q(x)}}
	\AxiomCm{ \p{\lnot Q(y) \lor R(x_2) }}
	\BinaryInfCm{ P(f(x)) \lor R(x_2) }

	\AxiomCm{ \p{\lnot R(x_5) \lor T(z)}}

	\AxiomCm{ \sig{\lnot S(z') \lor\lnot T(z')} }
	\AxiomCm{ \p{\lnot S(x_4)} }
	\BinaryInfCm{ \lnot T(x_4)}

	\BinaryInfCm{ \lnot R(x_5) }

	\BinaryInfCm{ P(f(x_4)) }
\end{prooftree}

~

\begin{prooftree}
	\AxiomCm{\bot \mid \sig{P(f(x)) \lor Q(x)}}
	\AxiomCm{\top \mid \p{\lnot Q(y) \lor R(x_2) }}
	\BinaryInfCm{ Q(x) \mid  P(f(x)) \lor R(x_2) }

	\AxiomCm{\top\mid \p{\lnot R(x_5) \lor T(z)}}

	\AxiomCm{\bot\mid \sig{\lnot S(z') \lor\lnot T(z')} }
	\AxiomCm{\top\mid \p{\lnot S(x_4)} }
	\BinaryInfCm{ \lnot S(x_4) \mid  \lnot T(x_4)}

	\BinaryInfCm{ \lnot T(x_4) \lor \lnot S(x_4) \mid \lnot R(x_5) }

	\BinaryInfCm{ \big(R(x_3) \land (\lnot T(x_4) \lor \lnot S(x_4))\big)\spas\lor \big(\lnot R(x_3) \land Q(x_4)\big) \spa\mid    P(f(x_4)) }
\end{prooftree}

again have arrow from $Q(x_4)$ to $P(f(x_4))$

\e{210c -- attempt to get var once in $\Delta$ and once in $\Gamma$-term without any arrow (seems to not work)}
\begin{prooftree}
	\AxiomCm{\sig{P(\arrowB f(x))\lor Q(\arrowA x)}} \drawAB
	\noLine
	\UnaryInfC{}

	\AxiomCm{\sig{\lnot Q(\arrowCD y) \lor R(\arrowDC y)}}\drawCCDD
	\noLine
	\UnaryInfC{}

	\BinaryInfCm{ \bot \mid P(\arrowB f(y)) \lor R(\arrowA y) } \drawAB
	\noLine
	\UnaryInfC{}

	\AxiomCm{\p{\lnot R(\arrowE z) \lor S(\arrowF g(z)))}} \drawEF
	\noLine
	\UnaryInfC{}

	\BinaryInfCm{ R(\arrowA\,\arrowE y) \mid P(\arrowB f(y)) \lor S(\arrowF g(y)) }\drawAB \drawEF
\end{prooftree}


$\Ra$ must port arrows on variable rename

\circled{?} $R$ possibly disappearing ($Q$ disappearing) doesn't matter?)

slow motion:
\begin{prooftree}
	\AxiomCm{\sig{P(\arrowB f(x))\lor Q(\arrowA x)}} \drawAB
	\noLine
	\UnaryInfC{}

	\AxiomCm{\sig{\lnot Q(\arrowCD y) \lor R(\arrowDC y)}}\drawCCDD
	\noLine
	\UnaryInfC{}

	\BinaryInfCm{\sigma = \{x\mapsto y\}}
	\noLine
	\UnaryInfC{Merge arrows of $Q(x)$ and $Q(y)$}
	\noLine
	\UnaryInfCm{ \bot \mid P(\arrowB f(y)) \lor R(\arrowA y) } \drawAB
	\noLine
	\UnaryInfC{}
\end{prooftree}


~
\section*{Further special cases which arose in proof}

\e{210f -- disappearing connection}

~

\begin{prooftree}
	\AxiomCm{\sig{\bot \mid P(f(\ha x)) \lor Q(\ha x)}}
	\AxiomCm{\sig{\bot \mid \lnot Q(\hb y) \lor R(g(\hb y))}}
	\BinaryInfCm{ \bot \mid P(f(x)) \lor R(g(x)) }
	\AxiomCm{ \sig{\bot \mid \lnot P(f(\hc z)) \lor S(\hc z)}}
	\AxiomCm{ \p{\top \mid \lnot S(a)}}
	\BinaryInfCm{ S(\arrowA a) \mid \lnot P(\arrowB f(a))} \drawAB
	\noLine\UnaryInfC{}
	\BinaryInfCm{ S(a)  \mid R(g(a))}
	\AxiomCm{\p{\top \mid \lnot R(u)}}
	\BinaryInfCm{ R(g(a)) \lor  S(a)  \mid \square}
\end{prooftree}

Gist: NEED MERGE ARROW for $P$ and $R$ OR COUNT disappearing literals, which is less effort


\e{210g -- unhandled backwards arrow}

~

\begin{prooftree}
	\AxiomCm{\sig{\bot \mid P(\arrowB f( y)) \lor Q(\arrowA y)}} \drawAB
	\noLine\UnaryInfC{}
	\AxiomCm{\sig{\bot \mid \lnot P(\arrowD f(g( x))) \lor R(\arrowC x)}} \drawCD
	\noLine\UnaryInfC{}
	\BinaryInfCm{{\bot \mid Q(g(x)) \lor R( x) }}
\end{prooftree}
Hidden literal: $P(f(g(x)))$

Suppose continuation with $\lnot R(a)$, $a$ is $\Delta$-term.
Then need $\forall x_1 \exists x_2 ( R(x_1) \lor Q(x_2))$
Cannot just merge $R$ and $Q$.

\begin{samepage}
CONT:\nopagebreak
\begin{prooftree}

	\AxiomCm{\p{\top \mid \lnot R(a) }}

	\AxiomCm{\sig{\bot \mid P(\arrowB f( y)) \lor Q(\arrowA y)}} \drawAB
	\noLine\UnaryInfC{}
	\AxiomCm{\sig{\bot \mid \lnot P(\arrowD f(g( x))) \lor R(\arrowC x)}} \drawCD
	\noLine\UnaryInfC{}
	\BinaryInfCm{{\bot \mid Q(g(x)) \lor R( x) }}

	\BinaryInfCm{R(a)  \mid Q(g(a)) }

\end{prooftree}
\end{samepage}

\NB{This does not follow the alleged invariant, the invariant holds without special quantifier ordering}

$\exists y_2 \forall x_1 ( R(x_1) \mid Q(y_2) )$

IN MORE DETAIL:


\mycols[5]{
	$ x_1 \sim a$   &
	$ y_2 \sim g(a)$ &
	$ y_3 \sim f(y)$&
	$ y_4 \sim f(g(x))$&
	$ y_5 \sim g(x)$
}
\begin{prooftree}
	\AxiomCm{\p{\forall x_1 \mid \lnot R(x_1) }}

	\AxiomCm{\sig{\exists y_3 \mid P(\arrowB y_3) \lor Q(\arrowA y)}} \drawAB
	\noLine\UnaryInfC{}
	\AxiomCm{\sig{\exists y_4 \mid \lnot P(\arrowD y_4) \lor R(\arrowC x)}} \drawCD
	\noLine\UnaryInfC{}
	\BinaryInfCm{{P(y_4)\mid \exists y_5 \exists y_4 \mid Q(y_5) \lor R( x) }}

	\BinaryInfCm{P(y_4)\mid   \exists \arrowA y_5 \forall \arrowC x_1 \exists \arrowD\,\arrowB y_4   \mid  R(x_1)  \mid Q(y_5) } \drawAB\drawCD

\end{prooftree}


\e{210g' -- same but more elaborate}

\begin{prooftree}
	\AxiomCm{ \sig{ \bot \mid \lnot S(b)}}

	\AxiomCm{\sig{\bot \mid P(f(x)) \lor R(x)}}
	\AxiomCm{\p{\top \mid \lnot R(g(y)) \lor S(y)}}
	\BinaryInfCm{ R(\arrB\,\arrE g(y)) \mid S(\arrA y) \lor P(\arrF f(g(y))) } \drawAB \drawEF
	\noLine\UnaryInfC{}

	\AxiomCm{ \sig{ \bot \mid Q(\arrowC z) \lor \lnot  P(\arrowD f(z))} } \drawCD
	\noLine\UnaryInfC{}
	\BinaryInfCm{ R(\arrB\,\arrE g(y)) \lor \lnot P(\arrF\,\arrD f(g(y))) \mid S(\arrA y) \lor Q(\arrC g(y)) } \drawAB \drawEF\drawCD
	\noLine\UnaryInfC{}

	\BinaryInfCm{ \lnot S( \arrA b) \land \Big( R(\arrB\,\arrE g(b)) \lor \lnot P(\arrF\,\arrD f(g(b)))\Big) \mid Q(\arrC g(b)) } \drawAB \drawEF\drawCD
\end{prooftree}

$ \exists y_1 \forall x_2 \exists y_3 ( \lnot S(y_1) \land ( R(x_2) \lor \lnot P(y_3)) \mid Q(x_2) )$



\clearpage 

\section*{$f(x) \lor g(x)$ with $f$, $g$ different colors}

\e{207a}
~

ORIGINAL VERSION:
\begin{prooftree}

	\AxiomCm{\p{\lnot P(z)}}
	\AxiomCm{\p{\lnot R(g(a))}}
	\AxiomCm{\sig{P(f(\arrowB x)) \lor Q(\arrowA x)}} \drawAB
	\AxiomCm{\p{R(g(\arrowF y)) \lor \lnot Q(\arrowE y)}} \drawEF
	\RightLabelm{y\mapsto x}
	\BinaryInfCm{\forall \arrowA\,\arrowE x_1 Q(x_1) \mid P(f(\arrowB x)) \lor R(g(\arrowF x)) }\drawAB\drawEF
	\RightLabelm{x\mapsto a}
	\BinaryInfCm{\forall \arrowA\,\arrowE x_1 Q(x_1)  \mid P(f(\arrowB a)) \comm{ R(g(\arrowF a))} }\drawAB\drawEF
	\RightLabelm{z\mapsto f(a)}
	\BinaryInfCm{\forall \arrowA\,\arrowE x_1 \exists \arrowB x_2 \big( Q(x_1) \lor P(x_2) \big) \comm{ R(g(\arrowF a))} }\drawAB\drawEF
\end{prooftree}

$\Ra$ free vars in the interpolant have to be overbound (if there are arrows, but we can just always do so)
\bigskip


VERSION WITH ``CURRENT'' ALGO:
\begin{multicols}{6}
	$x_4 = g(x)$

	$x_5 = g(a)$

	$x_6 = g(y)$

	$x_7 = f(x)$

	$x_8 = f(a)$

\end{multicols}
~
\begin{prooftree}
	\AxiomCm{\p{\lnot P(z)}}
	\AxiomCm{\p{\lnot R(x_5)}}
	\AxiomCm{\exists x_7 \mid \bot \mid~\sig{P(\arrowB x_7) \lor Q(\arrowA x)}} \drawAB
	\noLine
	\UnaryInfC{}
	\AxiomCm{\forall x_6 \mid \top \mid~\p{R(\arrowF x_6) \lor \lnot Q(\arrowE y)}} \drawEF
	\noLine
	\UnaryInfC{}
	\RightLabelm{y\mapsto x}
	\BinaryInfCm{\forall x_6 \exists x_7 \mid  (Q(\arrowA\,\arrowE x) \land \top) \lor (\lnot Q(x)\land \bot) \mid P(\arrowB x_7) \lor R(\arrowF x_6 )  }\drawAB\drawEF
	\noLine
	\UnaryInfC{}
	\RightLabelm{x\mapsto a}
	\BinaryInfCm{\forall x_1 \forall x_6 \exists x_7 \mid Q(\arrowA\,\arrowE x_1)  \mid P(\arrowB x_7) \comm{ R(\arrowF x_6)} }\drawAB\drawEF
	\noLine
	\UnaryInfC{}
	\RightLabelm{z\mapsto f(a)}
	\BinaryInfCm{\forall x_1 \exists x_8 \mid\big( Q(\arrowA\,\arrowE x_1) \lor P(\arrowB x_8) \big) \comm{ R(\arrowF x_6)} }\drawAB\drawEF
	\noLine
	\UnaryInfC{}
\end{prooftree}

$\Ra$ a free variable can be left as is as it is implicitly universally bound at highest level, which is also the case in the preceding clauses (else it would have been unified and changed)


\clearpage 
\section*{misc examples}

\e{201a}

\begin{prooftree}
	\AxiomCm{\sig{P(x, y) \lor \lnot Q(y)}}
	\AxiomCm{\p{\lnot P(a, y_2)}}
	\RightLabelm{x \mapsto a}
	\BinaryInfCm{\lnot Q(y)}

	\AxiomCm{\sig{Q(f(z)) \lor R(z)}}
	\AxiomCm{\p{\lnot R(a)} }
	\RightLabelm{z\mapsto a}
	\BinaryInfCm{Q(f(a)}
	\RightLabelm{y \mapsto f(a)}
	\BinaryInfCm{\square}
\end{prooftree}

\begin{multicols}{2}

	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{x \mapsto a}
		\BinaryInfCm{P(a, y)}

		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{z\mapsto a}
		\BinaryInfCm{R(a)}
		\RightLabelm{y \mapsto f(a)}
		\BinaryInfCm{P(a, f(a)) \lor R(a)}
	\end{prooftree}

	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{x \mapsto a}
		\BinaryInfCm{\forall x_1 P(x_1, y)}

		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{z\mapsto a}
		\BinaryInfCm{\forall x_3 R(x_3)}
		\RightLabelm{y \mapsto f(a)}
		\BinaryInfCm{\forall x_3 \forall x_1 \exists x_2 ( P(x_1, x_2) \lor R(x_3))}
	\end{prooftree}

\end{multicols}
Huang would produce: $\forall x_1 \exists x_2 P(x_1, x_2) \lor R(x_1) $


\e{201b}
\begin{prooftree}
	\AxiomCm{\sig{P(x, f(y)) \lor \lnot Q(f(y))}}
	\AxiomCm{\p{\lnot P(a, y_2)}}
	\RightLabelm{x \mapsto a}
	\BinaryInfCm{\lnot Q(f(y))}

	\AxiomCm{\sig{Q(f(z)) \lor R(z)}}
	\AxiomCm{\p{\lnot R(a)} }
	\RightLabelm{z\mapsto a}
	\BinaryInfCm{Q(f(a)}
	\RightLabelm{y \mapsto f(a)}
	\BinaryInfCm{\square}
\end{prooftree}

\begin{multicols}{2}

	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{x \mapsto a}
		\BinaryInfCm{P(a, f(y))}

		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{z\mapsto a}
		\BinaryInfCm{R(a)}
		\RightLabelm{y \mapsto a}
		\BinaryInfCm{P(a, f(a)) \lor R(a)}
	\end{prooftree}

	\begin{prooftree}
		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{x \mapsto a}
		\BinaryInfCm{\forall x_1 \exists x_2 P(x_1, x_2)}

		\AxiomCm{\bot}
		\AxiomCm{\top}
		\RightLabelm{z\mapsto a}
		\BinaryInfCm{\forall x_3 R(x_3)}
		\RightLabelm{y \mapsto f(a)}
		\BinaryInfCm{ \forall x_3 \forall x_1 \exists x_2 P(x_1, x_2) \lor R(x_3) }
	\end{prooftree}

\end{multicols}
Huang would produce: $\forall x_1 \exists x_2 P(x_1, x_2) \lor R(x_1) $


\clearpage

\section*{arrow in element which is not in interpolant or resolution clause}

\e{206}

\begin{prooftree}
	\AxiomCm{\sig{P(\arrowA x)\lor \lnot Q(f(\arrowB x))\drawAB}}
	\AxiomCm{\p{\lnot P(a)}}

	\RightLabelm{x\mapsto a}
	\BinaryInfCm{\forall \arrowA x_1 P(x_1) \mid \lnot Q(f(\arrowB a))\drawAB}

	\AxiomCm{\sig{Q(\arrowC y)\lor R(g(\arrowD y))\drawCD}}
	\AxiomCm{\p{\lnot R(z)}}

	\RightLabelm{z\mapsto g(y)}
	\BinaryInfCm{\exists \arrowD x_2 R(x_2) \mid Q(\arrowC y) \drawCD }

	\RightLabelm{y\mapsto f(a)}
	\BinaryInfCm{\forall x_1 \exists x_2( P(x_1) \lor R(x_2)) \mid \square}
	\noLine
	\UnaryInfCm{\color{gray} P(a) \lor R(g(f(a)))}
\end{prooftree}

{\huge

	for first interpolant, $\Sigma \not\entails \lift{\Delta}{\PI(C)}{x} \lor C$

	=> need to overbind clause as well

}

\clearpage
\section*{border cases: arrows not within supposedly connected components}

\e{211a}

\begin{prooftree}
	\AxiomCm{Q(\hb x) \lor P(f(\hb x, a))}
	\AxiomCm{\lnot Q(\ha y) \lor R(f(\ha y, b))}
	\BinaryInfCm{Q(\arrowA\,\arrowE x) \mid P(\arrowB f(x, a))  \lor R(\arrowF f(x, b))}\drawAB\drawEF
	\noLine\UnaryInfC{}\noLine\UnaryInfC{$\Ra$ no arr between $P$ and $R$}
\end{prooftree}

\e{211a'}

\begin{prooftree}
	\AxiomCm{\sig{Q(\hb x) \lor P(f(\hb x, a))}}
	\AxiomCm{\sig{\lnot Q(\ha y) \lor R(f(\ha y, b))}}
	\BinaryInfCm{Q(\arrowA\,\arrowE x) \mid P(\arrowB f(x, a))  \lor R(\arrowF f(x, b))}\drawAB\drawEF
	\noLine\UnaryInfC{}

	\AxiomCm{\sig{ \lnot P(\arrowD f(\hc u, z)) \lor S(\arrowC \hc u))}} \drawCD
	\noLine\UnaryInfC{}
	\AxiomCm{\p{\lnot S(c) }}
	\BinaryInfCm{{ S(\arrowC c) \mid \lnot P(\arrowD f(c, z)) }} \drawCD
	\noLine\UnaryInfC{}
	\BinaryInfCm{ (P(f(c, a) \land S(c)) \lor (\lnot P(f(c, a)) \land Q(c))) \mid R(f(c, b))}
\end{prooftree}

\begin{multicols}{6}
$ c \sim x_1$

$ f(c, a) \sim y_2$

$ f(c, b) \sim y_3$
\end{multicols}
$ (P(\arrowD y_2) \land S(\arrowC x_1)) \lor (\lnot P(\arrowF y_2) \land Q(\arrowA\,\arrowE x_1)) \mid R(\arrowB y_3) $ \drawAB \drawEF \drawCD NOTE: arrow merge on resolution is not drawn here (but is necessary)

$ \forall x_1 \exists y_2 \exists y_3$

this is not valid per se as the left hand side only contains $\Sigma$-formulas, but it probably could be fixed by adding some $\Pi$-inferences

Lesson is: no extra arrows needed, if a term enters, it does so via $x$, but there is a variable from the grey $x$ to both colored $x$.

\e{211b}
\begin{prooftree}
	\AxiomCm{Q(\hb x) \lor P(f(\hb x))}
	\AxiomCm{R(\ha y) \lor \lnot P(f(\ha y))}
	\BinaryInfCm{ P(\arrowB\,\arrowF f(x)) \mid Q(\arrowA x) \lor R(\arrowE x)  }\drawAB\drawEF
	\noLine\UnaryInfC{}\noLine\UnaryInfC{$\Ra$ no arr between $Q$ and $R$}
\end{prooftree}
\NB{should be fixed by backwards merging special case}

\e{211b'}
\begin{prooftree}
	\AxiomCm{\sig{Q(\hb x) \lor P(f(\hb x))}}
	\AxiomCm{\sig{R(\ha y) \lor \lnot P(f(\ha y))}}
	\BinaryInfCm{ P(\arrowB\,\arrowF f(x)) \mid Q(\arrowA x) \lor R(\arrowE x)  }\drawAB\drawEF
	\noLine\UnaryInfC{}
	\AxiomCm{\p{\lnot Q(a)}}
	\BinaryInfCm{ P(\arrowB\,\arrowF f(a)) \lor  Q(\arrowA a) \mid  R(\arrowE a)  }\drawAB\drawEF
	\noLine\UnaryInfC{}\noLine\UnaryInfC{\wrong{conjecture: $Q$ and $R$ do not need arrows as they are lifted by the same variable anyway, so constraints on $Q$ do the work}}
\end{prooftree}

\e{211c}
\begin{prooftree}
	\AxiomCm{ \sig{ Q(\arrowB f(x))\lor R(\arrowA x) } }\drawAB
	\noLine\UnaryInfC{}
	\AxiomCm{ \p{ \lnot R(g(y)) } }
	\BinaryInfCm{ Q(\arrowB f(g(y))) \lor R(\arrowA g(y)) }\drawAB
	\noLine\UnaryInfC{}
\end{prooftree}
Have same var but no merge arrow. The whole term $g(y)$ is somehow the ``travelling term'', there is no ``renaming''.
\clearpage

\section*{Example: no nice arrow start/end points}

\e{212a}

\begin{prooftree}
	\AxiomCm{ \bot \mid P(g(\arrowB f(y))) \lor Q(\arrowA y) }\drawAB
	\noLine\UnaryInfC{}
	\AxiomCm{ \top \mid \lnot Q(g(\arrowE x)) \lor R(h(\arrowF x))} \drawEF
	\noLine\UnaryInfC{}
	\BinaryInfCm{ Q(\arrowA g(\arrowE x)) \mid P(g(\arrowB f( g(x)))) \lor R(\arrowF h(x)) } \drawAB\drawEF
\end{prooftree}

	
{ \huge \bfseries

how to handle with components? problem with lifting vars? is this ok due to ``contains lifting term''-semantics?  

merge all terms which are contained in each other?

}

~

~

~



\end{document}
