\documentclass[final,compress]{beamer}
%\documentclass[draft,compress]{beamer}
% handout for no pauses
\usepackage{etex}
\usepackage{multicol}

\mode<presentation>{
%\usetheme{Dresden}
\usetheme{MyIlmenau}
%\setbeamertemplate{headline}{}
\setbeamertemplate{navigation symbols}{}
%\usepackage{beamerthemeshadow}
}
\makeatletter
\beamer@theme@subsectionfalse
\makeatother
%\usetheme{bars}

\setbeamercovered{transparent}
\usepackage{tabularx}


% setup colors
%\RequirePackage{xcolor}
%\selectcolormodel{cmyk}

\definecolor{DbaiDarkGreen}{cmyk}{0,0,0.2,0.4}
\definecolor{DbaiBrightGreen}{cmyk}{0.22,0.18,0.36,0}
\definecolor{ForsyteDarkYellow}{cmyk}{0,0.27,0.94,0.28}
\definecolor{ForsyteBrightYellow}{cmyk}{0,0.27,0.94,0.28}
\definecolor{KbsDarkBlue}{cmyk}{0.6,0.4,0,0.4}
\definecolor{KbsBrightBlue}{cmyk}{0.45,0.28,0,0.28}
\definecolor{InfosysDarkGrey}{gray}{0.4}
\definecolor{InfosysLightGrey}{gray}{0.6}
\definecolor{TuWienBlue}{cmyk}{1,0.38,0,0.15}
\definecolor{TuInfRed}{cmyk}{0,1,1,0}

\newcommand{\Vars}{\FV}
\DeclareMathOperator{\Lang}{L}

%\usepackage[authoryear]{natbib} % \cite ; square|round etc.
\bibliographystyle{apalike}
\bibdata{bib.bib}




\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[ngerman]{babel}

\input{/home/totycro/stud/latex-common/latex_header.tex}

\newcommand{\colOne}[1]{{\color{TuInfRed}#1}}
\newcommand{\colTwo}[1]{{\color{TuWienBlue}#1}}

\newcommand{\colA}[1]{\colOne{#1}}
\newcommand{\colB}[1]{\colTwo{#1}}


%\definecolor{darkgray}{rgb}{0.4, 0.4, 0.4}
\newcommand{\gray}[1]{{\color{InfosysDarkGrey}#1}}


% http://tikz.de/zweifarbige-buchstaben/
\tikzset{
   bclleft/.style={.},
   letter left/.style={bclleft/.append style={#1}},
   bclright/.style={.},
   letter right/.style={bclright/.append style={#1}},
}
\newcommand\bicolorletter[2][]{%
   \tikz[baseline=(n.base),inner sep=0pt,outer xsep=0pt,#1]{
     \node(n){\phantom{#2}};
     \foreach \a/\c in {west/bclleft,east/bclright}{
       \begin{scope}
         \clip(n.south)rectangle(n.north \a);
         \node[\c]at(n){${#2}$};
         %\node[\c]at(n){\textrm{#2}};
       \end{scope}
     }}}

\newcommand{\myA}{\tikzset{letter left=InfosysDarkGrey,letter right=TuInfRed}\bicolorletter{\ensuremath{\Gamma}}}
\newcommand{\myB}{\tikzset{letter left=InfosysDarkGrey,letter right=TuWienBlue}\bicolorletter{\ensuremath{\Delta}}}




% outline at begin of section:
\AtBeginSection[] {
  \begin{frame}
    \frametitle{Agenda}
    \tableofcontents[currentsection]
  \end{frame}
  \addtocounter{framenumber}{-1}
}


\usepackage{float}

\author{Bernhard Mallinger}
\title{Interpolation in First-Order Logic with Equality}
\subtitle{Master Thesis Presentation}
\institute{Advisor: Stefan Hetzl\medskip \\ Institute of
Discrete Mathematics and Geometry \\ TU Wien}
%\date{17. Dezember 2013}


\newcommand{\imgframe}[2]{ 
\imgframeWparams{#1}{#2}{width=1\textwidth}
}

\newcommand{\imgframeWparams}[3] {
\begin{frame}
	\frametitle{#1}
	\begin{center}
		\begin{figure}
			\includegraphics[#3]{#2}
		\end{figure}
	\end{center}
\end{frame}
}

\begin{document}
% for overlay
% \begin{frame}[<+->]

\frame{\titlepage}

\begin{frame}{Notes (cover this somewhere)}
	\begin{itemize}
		\item  interpolants can be extracted from resolution proofs since skolemisation and the cnf transformation doesn't change the set of interpolants
	\end{itemize}
\end{frame}

\begin{frame}{Agenda}
	\tableofcontents
\end{frame}

\section{Introduction}
\begin{frame}{Introduction}
	\color{green}
	\begin{itemize}
		\item Want concrete algorithms for FOL/EQ

			$\Rightarrow$ Little attention so far
		\item Present different constructive proofs
	\end{itemize}
	
\end{frame}

\section{Craig Interpolation (10 min)}

\subsection{}
\begin{frame}{Craig Interpolation}
	\textbf{Theorem} (Craig).
	\emph{Let \myA{}
		and \myB{} be sets of first-order formulas where
		\begin{itemize}
			\item \myA{} contains \colA{red} and \gray{gray} symbols and
			\item \myB{} contains \colB{blue} and \gray{gray} symbols
		\end{itemize}
		such that:
		\begin{itemize}
			\item $\myA\entails \myB$
		\end{itemize}

		~


		\begin{tabular}{p{.4\textwidth}p{.5\textwidth}}
			\mbox{Then there is a interpolant $\gray I$ containing only \gray{gray} symbols such that:}
			\begin{itemize}
				\item $\myA \entails \gray I$
				\item $\gray I \entails \myB$
			\end{itemize}
			&
			\begin{figure}
				\begin{tikzpicture}[
						implies/.style={double,double equal sign distance,-implies},
						mynode/.style={circle,outer sep=3pt}
					]
					\node[mynode] (A) at (0,0) {$\myA$};
					\node[mynode] (B) at (3,0) {$\myB$};
					\node[mynode] (I) at (1.5,-1.2) {$\gray I$};

					%\draw[->,implies] (A) to (B);
					\draw (A) edge[->,thick]  (B);
					\draw (A) edge[->,thick]  (I);
					\draw (I) edge[->,thick]  (B);
				\end{tikzpicture}
			\end{figure}
		\end{tabular}
	}
\end{frame}

\subsection{}
\begin{frame}{Interpolation and Equality}
	\begin{example}
		\begin{itemize}
			\item Let $\Gamma = \{\colA P(\gray a), \lnot \colA P(\gray b)\}$ and $\Delta = \{ \gray a \neq \gray b \}$.

			\item Clearly $\Gamma \entails \Delta$.
				
				\pause 
			\item Only possible interpolant: $\gray a \neq \gray b$
			\end{itemize}
	\end{example}
\end{frame}

\subsection{}
\begin{frame}{Applications}
	\begin{itemize}
		\item Proof of Beth's Definability Theorem
		\item Model checking
		\item Detecting loop invariants
	\end{itemize}
\end{frame}

\section{Proof by reduction (6 min)}
\newenvironment{myindentpar}[1]%
{\begin{list}{}%
		{\setlength{\leftmargin}{#1}}%
	\item[]%
	}
{\end{list}}


\subsection{}
\begin{frame}{Proof by reduction}
		Reduction to FOL without equality and function symbols:
		\vspace*{-2em}
		\begin{myindentpar}{1cm}
			\newcommand{\transformsep}{\;\to\;}
			\begin{align*}
				\intertext{Translate equality and function symbols:}
				%\gray P(\colA c) & \transformsep \exists x (\colA C(x) \land \gray P(x)) \\
				\Big(\gray P(\colA c)\Big)^*  & \, \equiv \, \exists x (\colA C(x) \land \gray P(x)) \\
				%\gray P(\colB f( \colA c)) & \transformsep  \exists x (  \exists y( \colA C(y) \land \colB F(y, x)) \land \gray P(x)) \\
				\Big( \gray P(\colB f( \colA c)) \Big)^* & \, \equiv \, \exists x (  \exists y( \colA C(y) \land \colB F(y, x)) \land \gray P(x))  \\
				%\gray s = \gray t & \transformsep \gray E(\gray s, \gray t) \\
				\Big( \gray s = \gray t \Big)^* & \, \equiv \, \gray E(\gray s, \gray t) \\
				\intertext{Add axioms for equality and new predicate symbols:}
				\varphi & ~\transformsep ~ \Big( \operatorname{T}_{\gray E} \land \bigwedge_{f \in \operatorname{FS}} \operatorname{T}_{\gray f} \Big) \limpl \varphi^*
			\end{align*}
	\end{myindentpar}
	Clearly $\varphi$ and $\varphi^*$ are equisatisfiable.
	\vspace*{1.5em}
\end{frame}

\subsection{}
\begin{frame}{Proof in FOL without equality and $\operatorname{FS}$}
	%\newcommand{\parti}[4]{\ensuremath{ \langle (#1; #2),\allowbreak (#3; #4)\rangle  }}

	%\newcommand{\partisym}{\ensuremath{\chi}}

	\begin{lemma}[Maehara]
		Let $\Gamma$ and $\Delta$ be sets of first-order formulas without equality and function symbols   such that $\Gamma \vdash \Delta$ is provable in \textbf{sequent calculus}.
		Then for any partition $\langle(\Gamma_1;\Delta_1),(\Gamma_2;\Delta_2)\rangle$
		there is an interpolant $I$ such that
		\begin{enumerate}
			\item $\Gamma_1 \proves \Delta_1, I$ is provable
			\item $\Gamma_2, I \proves \Delta_2$ is provable
			\item $\Lang(I) \subseteq \Lang(\Gamma_1, \Delta_1) \cap \Lang(\Gamma_2, \Delta_2)$
		\end{enumerate}
	\end{lemma}

	\pause
	\cite{baaz2011methods} presents a strengthening which includes function symbols.

	\textbf{Open question:} Can it be extended to include equality?
\end{frame}

\section{Interpolant extraction from resolution proofs (10 min)}

\subsection{}
\begin{frame}{Interpolant extraction}
	\begin{block}{Motivation}
		\begin{itemize}
			\item Proof by reduction is impractical
			\item Goal: Compute interpolants from proof
			\item The following is based on \cite{Huang95}
		\end{itemize}
	\end{block}
	\pause
	\begin{block}{Interpolant extraction from resolution proofs}
		\begin{itemize}
			\item Skolemisation and clausal form transformation do no alter the set of interpolants
			\item Have to use ``reverse'' (but equivalent) formulation of interpolation
		\end{itemize}
	\end{block}

\end{frame}
\newcommand{\fakemulticolwidth}{0.28\textwidth}
	\newcommand{\proofwidth}{0.18\textwidth}
	%\newcommand{\proofindent}{\hspace*{10.21em}}
	\newcommand{\proofindent}{\hspace*{11.21em}}
	%\newcommand{\proofwidth}{0.18\textwidth}
	%\newcommand{\proofindent}{\hspace*{10em}}

	%\newcommand{\stagearrow}{{\Large$\Downarrow$}}
	\newcommand{\stagearrow}{{\Large$\Downarrow$}}

\subsection{}
\begin{frame}{Huang's algorithm (1/2) (6 min)}
	\small
	%Approach:
	%\begin{enumerate}
	%	\item Inductively compute propositional interpolant for every clause of the refutation
	%	\item 
	%\end{enumerate}
	
	%\begin{tabularx}{\textwidth}{p{0.25\textwidth}p{0.2\textwidth}l}
	%\begin{tabular}{p{0.25\textwidth}p{0.35\textwidth}c}
	%\begin{tabular}{p{0.25\textwidth}ll}
	\begin{tabular}{p{0.25\textwidth}ll}

		Proof: 
		&
		%\begin{center}

		\multicolumn{1}{m{\fakemulticolwidth}}{
			\includegraphics[width=\proofwidth]{figures/two_phase_draft_proof}
		}
		%\rule{0.4\textwidth}{0.1\textwidth}
		%\end{center}
		&
		\vspace*{0.2em}
		\\

		%& \begin{center} \large\stagearrow \end{center} & 
		%\multicolumn{2}{c}{\emph{Extract structure from proof}}
		\multicolumn{2}{l}{
			\proofindent{\stagearrow} ~\parbox[c]{14em}{\raggedright \emph{ Extract propositional interpolant structure from proof}}
			\vspace*{0.2em}
		}
		\\

		%&  \Huge\stagearrow}   \\

	\begin{tabular}[x]{@{}l@{}}Propositional\\Interpolant:\end{tabular} 
		%	Propositional \newline interpolant: 
		&
		%\begin{center} \end{center}
		%\rule{0.4\textwidth}{0.1\textwidth}
		\multicolumn{1}{m{\fakemulticolwidth}}{
			\includegraphics[width=\proofwidth]{figures/two_phase_draft_proof}
		}
		$\dots \gray Q(\colA f(\colB c), \colB c) \dots$
		\vspace*{0.2em}
		\\
		\multicolumn{2}{l}{
			\proofindent{\stagearrow} ~\parbox[c]{12em}{\raggedright \emph{ Replace colored function and constant symbols }}
			\vspace*{0.2em}
		}
		\\

	\begin{tabular}[x]{@{}l@{}}Prenex\\First-Order\\Interpolant:\end{tabular} 
		&
		\multicolumn{1}{m{\fakemulticolwidth}}{
			\includegraphics[width=\proofwidth]{figures/two_phase_draft_fo_interpolant}
		}
		$\exists {x_3} \forall {x_5} \dots \gray Q({x_5}, {x_3}) \dots$
		\\


	\end{tabular}

\end{frame}

\subsection{}
\begin{frame}{Huang's algorithm (2/2)}
	\begin{itemize}
		%\item Outline of the proof? (
		\item Propositional interpolant is interpolant modulo function and constant symbols
		\item For the lifting phase, the ordering of the lifting variables is crucial
		\item The type of the quantifier is determined by the coloring of the symbol

			\begin{theorem}
				The number of quantifier alternations in the resulting interpolant directly corresponds to the number of color alternations of terms in the resolution proof.
			\end{theorem}
	\end{itemize}
\end{frame}


\newcommand{\onePhaseArrowLabel}{Combined structure extraction and replacing of colored symbols}

\subsection{}
\begin{frame}{Interpolation extraction in one phase}
	\small
	\begin{tabular}{p{0.25\textwidth}ll}

		Proof: 
		&

		\multicolumn{1}{m{\fakemulticolwidth}}{
			\includegraphics[width=\proofwidth]{figures/two_phase_draft_proof}
		}
		&
		\vspace*{0.2em}
		\\

		\multicolumn{2}{l}{
			\proofindent{\stagearrow} ~\parbox[c]{15em}{\raggedright\emph{ \onePhaseArrowLabel } }
			\vspace*{0.2em}
		}
		\\

	\begin{tabular}[x]{@{}l@{}}Interpolant\\modulo\\current clause:\end{tabular} 
		&
		\multicolumn{1}{m{\fakemulticolwidth}}{
			\includegraphics[width=\proofwidth]{figures/one_phase_draft_intermediate}
		}
		$\forall {x_5} \dots \gray Q({x_5}, \colB c) \dots$
		\vspace*{0.2em}
		\\

		\multicolumn{3}{l}{
			\hspace*{5em}
			\parbox[c]{13.3em}{\emph{Recursively applied to all inferences of the proof results in:}}
			%\proofindent{\stagearrow} ~\parbox[c]{15em}{\raggedright\emph{ \onePhaseArrowLabel } }
			%				\vspace*{0.5em}
			\vspace*{0.5em}
		}
		\\


		%			\multicolumn{2}{l}{
		%				\proofindent
		%				$\left.
		%				\parbox[c]{2em}{
		%					\stagearrow\\
		%					\hspace*{0.318em}$\vdots$ \\[0.27\baselineskip]
		%					\stagearrow
		%				}
		%			\right\} 
		%			\parbox[t]{11em}{\emph{Combined extraction and replacing phases}}
		%			$
		%				\vspace*{0.5em}
		%			} 
		%		 \\

	\begin{tabular}[x]{@{}l@{}}Non-Prenex\\First-Order\\Interpolant:\end{tabular} 
		&
		\multicolumn{1}{m{\fakemulticolwidth}}{
			\includegraphics[width=\proofwidth]{figures/two_phase_draft_fo_interpolant}
		}
		$\exists {x_3} \dots \forall {x_5} \dots \gray Q({x_5}, {x_3}) \dots$
		\\



	\end{tabular}

\end{frame}

\section{Semantic Proof (6 min)}
\begin{frame}
\end{frame}

\section{Conclusion}
\begin{frame}{Conclusion}
	\begin{itemize}
		\item Craig's and Huang's proof based interpolant extraction from proofs

			$\Rightarrow$ differ in applicability 

		\item Craig shows that the interpolation theorem holds also in FOL/EQ
		\item Huang shows that interpolants can efficiently be extracted in FOL/EQ

			\begin{itemize}
				\item Does not require different methods
				\item Little attention so far in research
			\end{itemize}

		\item Interpolation also allows for a model theoretic approach

	\end{itemize}
\end{frame}

\subsection{References}
\begin{frame}
	\bibliography{bib}
\end{frame}

\end{document}
